开始时间,SQL 语句,数据库,User来源,IP来源,执行时间（s）,锁时间（s）,扫描行数,返回行数
"2023-10-28 21:19:26","SELECT
            GROUP_CONCAT( DISTINCT sbca.attr_name, ':', sav.attr_value ORDER BY tosaj.onlinestore_single_attr_join_id ) AS attrText,
            IFNULL(GROUP_CONCAT( DISTINCT ts.warehouse_id, ':',ts.physical_inventory ORDER BY tw.warehouse_type DESC),'')                               AS widAndStock,
            tosp.dealer_product_join_id                                                                                 AS dealerProductJoinId,
            tosp.product_id                                                                                             AS productId,
            tosp.single_product_id                                                                                      AS singleProductId,
            tosp.onlinestore_single_product_inner_id                                                                    AS onlineStoreSingleProductId,
            tosp.onlinestore_single_product_outer_id                                                                    AS onlineStoreSingleProductOutId,
            ts.warehouse_id                                                                                             AS warehouseId,
            IFNULL(ts.physical_inventory,0)                                                                             AS stockNum
        FROM
            tenant_onlinestore_single_product tosp
            LEFT JOIN tenant_stock ts ON ts.single_product_id = tosp.single_product_id AND ts.is_del = 0
            LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspusj.shipper_id = ts.warehouse_id AND tspusj.is_del = 0
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id AND tw.is_del = 0
            LEFT JOIN tenant_store tss ON tss.store_inner_id = tw.warehouse_store_id
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON sav.attr_value_id = tosaj.attr_value_id
        WHERE
            tosp.is_del = 0
            AND tosp.is_enable = 1
            AND ( ( tw.warehouse_type = 1 AND tss.store_status = 0 ) OR tw.warehouse_type = 0 )
             
             
        GROUP BY
            tosp.single_product_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","39.152","0","31260528","5884"
"2023-10-28 21:20:36","SELECT
            GROUP_CONCAT( DISTINCT sbca.attr_name, ':', sav.attr_value ORDER BY tosaj.onlinestore_single_attr_join_id ) AS attrText,
            IFNULL(GROUP_CONCAT( DISTINCT ts.warehouse_id, ':',ts.physical_inventory ORDER BY tw.warehouse_type DESC),'')                               AS widAndStock,
            tosp.dealer_product_join_id                                                                                 AS dealerProductJoinId,
            tosp.product_id                                                                                             AS productId,
            tosp.single_product_id                                                                                      AS singleProductId,
            tosp.onlinestore_single_product_inner_id                                                                    AS onlineStoreSingleProductId,
            tosp.onlinestore_single_product_outer_id                                                                    AS onlineStoreSingleProductOutId,
            ts.warehouse_id                                                                                             AS warehouseId,
            IFNULL(ts.physical_inventory,0)                                                                             AS stockNum
        FROM
            tenant_onlinestore_single_product tosp
            LEFT JOIN tenant_stock ts ON ts.single_product_id = tosp.single_product_id AND ts.is_del = 0
            LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspusj.shipper_id = ts.warehouse_id AND tspusj.is_del = 0
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id AND tw.is_del = 0
            LEFT JOIN tenant_store tss ON tss.store_inner_id = tw.warehouse_store_id
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON sav.attr_value_id = tosaj.attr_value_id
        WHERE
            tosp.is_del = 0
            AND tosp.is_enable = 1
            AND ( ( tw.warehouse_type = 1 AND tss.store_status = 0 ) OR tw.warehouse_type = 0 )
             
             
        GROUP BY
            tosp.single_product_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","38.45","0","31260528","5884"
"2023-10-28 21:17:06","SELECT
            GROUP_CONCAT( DISTINCT sbca.attr_name, ':', sav.attr_value ORDER BY tosaj.onlinestore_single_attr_join_id ) AS attrText,
            IFNULL(GROUP_CONCAT( DISTINCT ts.warehouse_id, ':',ts.physical_inventory ORDER BY tw.warehouse_type DESC),'')                               AS widAndStock,
            tosp.dealer_product_join_id                                                                                 AS dealerProductJoinId,
            tosp.product_id                                                                                             AS productId,
            tosp.single_product_id                                                                                      AS singleProductId,
            tosp.onlinestore_single_product_inner_id                                                                    AS onlineStoreSingleProductId,
            tosp.onlinestore_single_product_outer_id                                                                    AS onlineStoreSingleProductOutId,
            ts.warehouse_id                                                                                             AS warehouseId,
            IFNULL(ts.physical_inventory,0)                                                                             AS stockNum
        FROM
            tenant_onlinestore_single_product tosp
            LEFT JOIN tenant_stock ts ON ts.single_product_id = tosp.single_product_id AND ts.is_del = 0
            LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspusj.shipper_id = ts.warehouse_id AND tspusj.is_del = 0
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id AND tw.is_del = 0
            LEFT JOIN tenant_store tss ON tss.store_inner_id = tw.warehouse_store_id
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON sav.attr_value_id = tosaj.attr_value_id
        WHERE
            tosp.is_del = 0
            AND tosp.is_enable = 1
            AND ( ( tw.warehouse_type = 1 AND tss.store_status = 0 ) OR tw.warehouse_type = 0 )
             
             
        GROUP BY
            tosp.single_product_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","38.403","0","31260528","5884"
"2023-10-28 21:17:42","SELECT
            GROUP_CONCAT( DISTINCT sbca.attr_name, ':', sav.attr_value ORDER BY tosaj.onlinestore_single_attr_join_id ) AS attrText,
            IFNULL(GROUP_CONCAT( DISTINCT ts.warehouse_id, ':',ts.physical_inventory ORDER BY tw.warehouse_type DESC),'')                               AS widAndStock,
            tosp.dealer_product_join_id                                                                                 AS dealerProductJoinId,
            tosp.product_id                                                                                             AS productId,
            tosp.single_product_id                                                                                      AS singleProductId,
            tosp.onlinestore_single_product_inner_id                                                                    AS onlineStoreSingleProductId,
            tosp.onlinestore_single_product_outer_id                                                                    AS onlineStoreSingleProductOutId,
            ts.warehouse_id                                                                                             AS warehouseId,
            IFNULL(ts.physical_inventory,0)                                                                             AS stockNum
        FROM
            tenant_onlinestore_single_product tosp
            LEFT JOIN tenant_stock ts ON ts.single_product_id = tosp.single_product_id AND ts.is_del = 0
            LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspusj.shipper_id = ts.warehouse_id AND tspusj.is_del = 0
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id AND tw.is_del = 0
            LEFT JOIN tenant_store tss ON tss.store_inner_id = tw.warehouse_store_id
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON sav.attr_value_id = tosaj.attr_value_id
        WHERE
            tosp.is_del = 0
            AND tosp.is_enable = 1
            AND ( ( tw.warehouse_type = 1 AND tss.store_status = 0 ) OR tw.warehouse_type = 0 )
             
             
        GROUP BY
            tosp.single_product_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","38.192","0","31260528","5884"
"2023-10-27 11:35:59","SELECT
            GROUP_CONCAT( DISTINCT sbca.attr_name, ':', sav.attr_value ORDER BY tosaj.onlinestore_single_attr_join_id ) AS attrText,
            IFNULL(GROUP_CONCAT( DISTINCT ts.warehouse_id, ':',ts.physical_inventory ORDER BY tw.warehouse_type DESC),'')                               AS widAndStock,
            tosp.dealer_product_join_id                                                                                 AS dealerProductJoinId,
            tosp.product_id                                                                                             AS productId,
            tosp.single_product_id                                                                                      AS singleProductId,
            tosp.onlinestore_single_product_inner_id                                                                    AS onlineStoreSingleProductId,
            tosp.onlinestore_single_product_outer_id                                                                    AS onlineStoreSingleProductOutId,
            ts.warehouse_id                                                                                             AS warehouseId,
            IFNULL(ts.physical_inventory,0)                                                                             AS stockNum
        FROM
            tenant_onlinestore_single_product tosp
            LEFT JOIN tenant_stock ts ON ts.single_product_id = tosp.single_product_id AND ts.is_del = 0
            LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspusj.shipper_id = ts.warehouse_id AND tspusj.is_del = 0
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id AND tw.is_del = 0
            LEFT JOIN tenant_store tss ON tss.store_inner_id = tw.warehouse_store_id
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON sav.attr_value_id = tosaj.attr_value_id
        WHERE
            tosp.is_del = 0
            AND tosp.is_enable = 1
            AND ( ( tw.warehouse_type = 1 AND tss.store_status = 0 ) OR tw.warehouse_type = 0 )
             
             
        GROUP BY
            tosp.single_product_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","38.102","0","30939358","5819"
"2023-10-28 20:44:19","SELECT
            GROUP_CONCAT( DISTINCT sbca.attr_name, ':', sav.attr_value ORDER BY tosaj.onlinestore_single_attr_join_id ) AS attrText,
            IFNULL(GROUP_CONCAT( DISTINCT ts.warehouse_id, ':',ts.physical_inventory ORDER BY tw.warehouse_type DESC),'')                               AS widAndStock,
            tosp.dealer_product_join_id                                                                                 AS dealerProductJoinId,
            tosp.product_id                                                                                             AS productId,
            tosp.single_product_id                                                                                      AS singleProductId,
            tosp.onlinestore_single_product_inner_id                                                                    AS onlineStoreSingleProductId,
            tosp.onlinestore_single_product_outer_id                                                                    AS onlineStoreSingleProductOutId,
            ts.warehouse_id                                                                                             AS warehouseId,
            IFNULL(ts.physical_inventory,0)                                                                             AS stockNum
        FROM
            tenant_onlinestore_single_product tosp
            LEFT JOIN tenant_stock ts ON ts.single_product_id = tosp.single_product_id AND ts.is_del = 0
            LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspusj.shipper_id = ts.warehouse_id AND tspusj.is_del = 0
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id AND tw.is_del = 0
            LEFT JOIN tenant_store tss ON tss.store_inner_id = tw.warehouse_store_id
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON sav.attr_value_id = tosaj.attr_value_id
        WHERE
            tosp.is_del = 0
            AND tosp.is_enable = 1
            AND ( ( tw.warehouse_type = 1 AND tss.store_status = 0 ) OR tw.warehouse_type = 0 )
             
             
        GROUP BY
            tosp.single_product_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","37.709","0","31260499","5884"
"2023-10-28 20:45:12","SELECT
            GROUP_CONCAT( DISTINCT sbca.attr_name, ':', sav.attr_value ORDER BY tosaj.onlinestore_single_attr_join_id ) AS attrText,
            IFNULL(GROUP_CONCAT( DISTINCT ts.warehouse_id, ':',ts.physical_inventory ORDER BY tw.warehouse_type DESC),'')                               AS widAndStock,
            tosp.dealer_product_join_id                                                                                 AS dealerProductJoinId,
            tosp.product_id                                                                                             AS productId,
            tosp.single_product_id                                                                                      AS singleProductId,
            tosp.onlinestore_single_product_inner_id                                                                    AS onlineStoreSingleProductId,
            tosp.onlinestore_single_product_outer_id                                                                    AS onlineStoreSingleProductOutId,
            ts.warehouse_id                                                                                             AS warehouseId,
            IFNULL(ts.physical_inventory,0)                                                                             AS stockNum
        FROM
            tenant_onlinestore_single_product tosp
            LEFT JOIN tenant_stock ts ON ts.single_product_id = tosp.single_product_id AND ts.is_del = 0
            LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspusj.shipper_id = ts.warehouse_id AND tspusj.is_del = 0
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id AND tw.is_del = 0
            LEFT JOIN tenant_store tss ON tss.store_inner_id = tw.warehouse_store_id
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON sav.attr_value_id = tosaj.attr_value_id
        WHERE
            tosp.is_del = 0
            AND tosp.is_enable = 1
            AND ( ( tw.warehouse_type = 1 AND tss.store_status = 0 ) OR tw.warehouse_type = 0 )
             
             
        GROUP BY
            tosp.single_product_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","37.59","0","31260499","5884"
"2023-10-27 10:13:53","SELECT
            tdpj.dealer_product_join_id,
            tdpj.dealer_product_join_outer_id,
            tdpj.dealer_product_name,
            tdpj.main_cover,
            IFNULL( topd.count, 0 ) AS count,
            stock.physical_inventory AS stock
        FROM
            tenant_flash_sales tfs
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
            LEFT JOIN (
                SELECT
                    topd.dealer_product_join_id,
                    COUNT( topd.dealer_product_join_id ) AS count
                FROM
                    tenant_order tor
                    LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
                    AND topd.is_del = 0
                WHERE
                    tor.is_del = 0
                    AND tor.order_status != 6
                GROUP BY
                    topd.dealer_product_join_id
            ) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		    LEFT JOIN (
		    		SELECT
		    			tdpj.dealer_product_join_id,
		    			SUM( ts.physical_inventory ) AS physical_inventory
		    		FROM
		    			tenant_dealer_product_join tdpj
		    			LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
		    				AND tosp.is_del = 0
		    			LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
		    		WHERE
		    			tdpj.is_del = 0
		    			AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
                                     
                                        AND ts.store_inner_id = -1
                                     
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
                                         
                                                AND ts.store_inner_id = -1
                                             
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
		    		AND ts.physical_inventory IS NOT NULL
		    		GROUP BY
		    		tosp.dealer_product_join_id
		    ) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
        WHERE
            tfs.is_del = 0
            AND tfs.flash_sales_id = 24
            AND tdpj.is_del = 0
            AND tdpj.is_complete = 1
             
             
             
             
        GROUP BY
            tdpj.dealer_product_join_id
        ORDER BY
             
            tdpj.dealer_product_join_id LIMIT 40,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","10.91","0","7655380","20"
"2023-10-27 10:11:07","SELECT COUNT(1) FROM ( SELECT tdpj.dealer_product_join_id, tdpj.dealer_product_join_outer_id, tdpj.dealer_product_name, tdpj.main_cover, IFNULL(topd.count, 0) AS count, stock.physical_inventory AS stock FROM tenant_flash_sales tfs LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id LEFT JOIN (SELECT topd.dealer_product_join_id, COUNT(topd.dealer_product_join_id) AS count FROM tenant_order tor LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id AND topd.is_del = 0 WHERE tor.is_del = 0 AND tor.order_status != 6 GROUP BY topd.dealer_product_join_id) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id LEFT JOIN (SELECT tdpj.dealer_product_join_id, SUM(ts.physical_inventory) AS physical_inventory FROM tenant_dealer_product_join tdpj LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id AND tosp.is_del = 0 LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id WHERE tdpj.is_del = 0 AND ((tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0)) OR (tdpj.has_pick_up = 1 AND tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0 UNION SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0)) OR (tdpj.has_pick_up = 1 AND ts.warehouse_id IN (SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0))) AND ts.physical_inventory IS NOT NULL GROUP BY tosp.dealer_product_join_id) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id WHERE tfs.is_del = 0 AND tfs.flash_sales_id = 24 AND tdpj.is_del = 0 AND tdpj.is_complete = 1 GROUP BY tdpj.dealer_product_join_id ORDER BY tdpj.dealer_product_join_id ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","10.616","0.001","7655468","1"
"2023-10-27 10:13:42","SELECT COUNT(1) FROM ( SELECT tdpj.dealer_product_join_id, tdpj.dealer_product_join_outer_id, tdpj.dealer_product_name, tdpj.main_cover, IFNULL(topd.count, 0) AS count, stock.physical_inventory AS stock FROM tenant_flash_sales tfs LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id LEFT JOIN (SELECT topd.dealer_product_join_id, COUNT(topd.dealer_product_join_id) AS count FROM tenant_order tor LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id AND topd.is_del = 0 WHERE tor.is_del = 0 AND tor.order_status != 6 GROUP BY topd.dealer_product_join_id) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id LEFT JOIN (SELECT tdpj.dealer_product_join_id, SUM(ts.physical_inventory) AS physical_inventory FROM tenant_dealer_product_join tdpj LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id AND tosp.is_del = 0 LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id WHERE tdpj.is_del = 0 AND ((tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0)) OR (tdpj.has_pick_up = 1 AND tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0 UNION SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0)) OR (tdpj.has_pick_up = 1 AND ts.warehouse_id IN (SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0))) AND ts.physical_inventory IS NOT NULL GROUP BY tosp.dealer_product_join_id) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id WHERE tfs.is_del = 0 AND tfs.flash_sales_id = 24 AND tdpj.is_del = 0 AND tdpj.is_complete = 1 GROUP BY tdpj.dealer_product_join_id ORDER BY tdpj.dealer_product_join_id ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","10.484","0","7655468","1"
"2023-10-27 10:12:01","SELECT COUNT(1) FROM ( SELECT tdpj.dealer_product_join_id, tdpj.dealer_product_join_outer_id, tdpj.dealer_product_name, tdpj.main_cover, IFNULL(topd.count, 0) AS count, stock.physical_inventory AS stock FROM tenant_flash_sales tfs LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id LEFT JOIN (SELECT topd.dealer_product_join_id, COUNT(topd.dealer_product_join_id) AS count FROM tenant_order tor LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id AND topd.is_del = 0 WHERE tor.is_del = 0 AND tor.order_status != 6 GROUP BY topd.dealer_product_join_id) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id LEFT JOIN (SELECT tdpj.dealer_product_join_id, SUM(ts.physical_inventory) AS physical_inventory FROM tenant_dealer_product_join tdpj LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id AND tosp.is_del = 0 LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id WHERE tdpj.is_del = 0 AND ((tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0)) OR (tdpj.has_pick_up = 1 AND tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0 UNION SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0)) OR (tdpj.has_pick_up = 1 AND ts.warehouse_id IN (SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0))) AND ts.physical_inventory IS NOT NULL GROUP BY tosp.dealer_product_join_id) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id WHERE tfs.is_del = 0 AND tfs.flash_sales_id = 24 AND tdpj.is_del = 0 AND tdpj.is_complete = 1 GROUP BY tdpj.dealer_product_join_id ORDER BY tdpj.dealer_product_join_id ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","10.306","0","7655468","1"
"2023-10-27 10:13:11","SELECT COUNT(1) FROM ( SELECT tdpj.dealer_product_join_id, tdpj.dealer_product_join_outer_id, tdpj.dealer_product_name, tdpj.main_cover, IFNULL(topd.count, 0) AS count, stock.physical_inventory AS stock FROM tenant_flash_sales tfs LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id LEFT JOIN (SELECT topd.dealer_product_join_id, COUNT(topd.dealer_product_join_id) AS count FROM tenant_order tor LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id AND topd.is_del = 0 WHERE tor.is_del = 0 AND tor.order_status != 6 GROUP BY topd.dealer_product_join_id) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id LEFT JOIN (SELECT tdpj.dealer_product_join_id, SUM(ts.physical_inventory) AS physical_inventory FROM tenant_dealer_product_join tdpj LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id AND tosp.is_del = 0 LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id WHERE tdpj.is_del = 0 AND ((tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0)) OR (tdpj.has_pick_up = 1 AND tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0 UNION SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0)) OR (tdpj.has_pick_up = 1 AND ts.warehouse_id IN (SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0))) AND ts.physical_inventory IS NOT NULL GROUP BY tosp.dealer_product_join_id) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id WHERE tfs.is_del = 0 AND tfs.flash_sales_id = 24 AND tdpj.is_del = 0 AND tdpj.is_complete = 1 GROUP BY tdpj.dealer_product_join_id ORDER BY tdpj.dealer_product_join_id ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","10.288","0","7655468","1"
"2023-10-27 10:13:22","SELECT
            tdpj.dealer_product_join_id,
            tdpj.dealer_product_join_outer_id,
            tdpj.dealer_product_name,
            tdpj.main_cover,
            IFNULL( topd.count, 0 ) AS count,
            stock.physical_inventory AS stock
        FROM
            tenant_flash_sales tfs
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
            LEFT JOIN (
                SELECT
                    topd.dealer_product_join_id,
                    COUNT( topd.dealer_product_join_id ) AS count
                FROM
                    tenant_order tor
                    LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
                    AND topd.is_del = 0
                WHERE
                    tor.is_del = 0
                    AND tor.order_status != 6
                GROUP BY
                    topd.dealer_product_join_id
            ) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		    LEFT JOIN (
		    		SELECT
		    			tdpj.dealer_product_join_id,
		    			SUM( ts.physical_inventory ) AS physical_inventory
		    		FROM
		    			tenant_dealer_product_join tdpj
		    			LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
		    				AND tosp.is_del = 0
		    			LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
		    		WHERE
		    			tdpj.is_del = 0
		    			AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
                                     
                                        AND ts.store_inner_id = -1
                                     
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
                                         
                                                AND ts.store_inner_id = -1
                                             
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
		    		AND ts.physical_inventory IS NOT NULL
		    		GROUP BY
		    		tosp.dealer_product_join_id
		    ) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
        WHERE
            tfs.is_del = 0
            AND tfs.flash_sales_id = 24
            AND tdpj.is_del = 0
            AND tdpj.is_complete = 1
             
             
             
             
        GROUP BY
            tdpj.dealer_product_join_id
        ORDER BY
             
            tdpj.dealer_product_join_id LIMIT 20,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","10.272","0","7655360","20"
"2023-10-27 10:12:32","SELECT COUNT(1) FROM ( SELECT tdpj.dealer_product_join_id, tdpj.dealer_product_join_outer_id, tdpj.dealer_product_name, tdpj.main_cover, IFNULL(topd.count, 0) AS count, stock.physical_inventory AS stock FROM tenant_flash_sales tfs LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id LEFT JOIN (SELECT topd.dealer_product_join_id, COUNT(topd.dealer_product_join_id) AS count FROM tenant_order tor LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id AND topd.is_del = 0 WHERE tor.is_del = 0 AND tor.order_status != 6 GROUP BY topd.dealer_product_join_id) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id LEFT JOIN (SELECT tdpj.dealer_product_join_id, SUM(ts.physical_inventory) AS physical_inventory FROM tenant_dealer_product_join tdpj LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id AND tosp.is_del = 0 LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id WHERE tdpj.is_del = 0 AND ((tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0)) OR (tdpj.has_pick_up = 1 AND tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0 UNION SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0)) OR (tdpj.has_pick_up = 1 AND ts.warehouse_id IN (SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0))) AND ts.physical_inventory IS NOT NULL GROUP BY tosp.dealer_product_join_id) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id WHERE tfs.is_del = 0 AND tfs.flash_sales_id = 24 AND tdpj.is_del = 0 AND tdpj.is_complete = 1 GROUP BY tdpj.dealer_product_join_id ORDER BY tdpj.dealer_product_join_id ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","10.199","0","7655468","1"
"2023-10-27 10:14:41","SELECT COUNT(1) FROM ( SELECT tdpj.dealer_product_join_id, tdpj.dealer_product_join_outer_id, tdpj.dealer_product_name, tdpj.main_cover, IFNULL(topd.count, 0) AS count, stock.physical_inventory AS stock FROM tenant_flash_sales tfs LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id LEFT JOIN (SELECT topd.dealer_product_join_id, COUNT(topd.dealer_product_join_id) AS count FROM tenant_order tor LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id AND topd.is_del = 0 WHERE tor.is_del = 0 AND tor.order_status != 6 GROUP BY topd.dealer_product_join_id) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id LEFT JOIN (SELECT tdpj.dealer_product_join_id, SUM(ts.physical_inventory) AS physical_inventory FROM tenant_dealer_product_join tdpj LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id AND tosp.is_del = 0 LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id WHERE tdpj.is_del = 0 AND ((tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0)) OR (tdpj.has_pick_up = 1 AND tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0 UNION SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0)) OR (tdpj.has_pick_up = 1 AND ts.warehouse_id IN (SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0))) AND ts.physical_inventory IS NOT NULL GROUP BY tosp.dealer_product_join_id) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id WHERE tfs.is_del = 0 AND tfs.flash_sales_id = 24 AND tdpj.is_del = 0 AND tdpj.is_complete = 1 GROUP BY tdpj.dealer_product_join_id ORDER BY tdpj.dealer_product_join_id ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","10.159","0","7655468","1"
"2023-10-27 10:12:42","SELECT
            tdpj.dealer_product_join_id,
            tdpj.dealer_product_join_outer_id,
            tdpj.dealer_product_name,
            tdpj.main_cover,
            IFNULL( topd.count, 0 ) AS count,
            stock.physical_inventory AS stock
        FROM
            tenant_flash_sales tfs
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
            LEFT JOIN (
                SELECT
                    topd.dealer_product_join_id,
                    COUNT( topd.dealer_product_join_id ) AS count
                FROM
                    tenant_order tor
                    LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
                    AND topd.is_del = 0
                WHERE
                    tor.is_del = 0
                    AND tor.order_status != 6
                GROUP BY
                    topd.dealer_product_join_id
            ) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		    LEFT JOIN (
		    		SELECT
		    			tdpj.dealer_product_join_id,
		    			SUM( ts.physical_inventory ) AS physical_inventory
		    		FROM
		    			tenant_dealer_product_join tdpj
		    			LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
		    				AND tosp.is_del = 0
		    			LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
		    		WHERE
		    			tdpj.is_del = 0
		    			AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
                                     
                                        AND ts.store_inner_id = -1
                                     
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
                                         
                                                AND ts.store_inner_id = -1
                                             
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
		    		AND ts.physical_inventory IS NOT NULL
		    		GROUP BY
		    		tosp.dealer_product_join_id
		    ) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
        WHERE
            tfs.is_del = 0
            AND tfs.flash_sales_id = 24
            AND tdpj.is_del = 0
            AND tdpj.is_complete = 1
             
             
             
             
        GROUP BY
            tdpj.dealer_product_join_id
        ORDER BY
             
            tdpj.dealer_product_join_id LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","10.143","0","7655340","20"
"2023-10-27 10:12:11","SELECT
            tdpj.dealer_product_join_id,
            tdpj.dealer_product_join_outer_id,
            tdpj.dealer_product_name,
            tdpj.main_cover,
            IFNULL( topd.count, 0 ) AS count,
            stock.physical_inventory AS stock
        FROM
            tenant_flash_sales tfs
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
            LEFT JOIN (
                SELECT
                    topd.dealer_product_join_id,
                    COUNT( topd.dealer_product_join_id ) AS count
                FROM
                    tenant_order tor
                    LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
                    AND topd.is_del = 0
                WHERE
                    tor.is_del = 0
                    AND tor.order_status != 6
                GROUP BY
                    topd.dealer_product_join_id
            ) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		    LEFT JOIN (
		    		SELECT
		    			tdpj.dealer_product_join_id,
		    			SUM( ts.physical_inventory ) AS physical_inventory
		    		FROM
		    			tenant_dealer_product_join tdpj
		    			LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
		    				AND tosp.is_del = 0
		    			LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
		    		WHERE
		    			tdpj.is_del = 0
		    			AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
                                     
                                        AND ts.store_inner_id = -1
                                     
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
                                         
                                                AND ts.store_inner_id = -1
                                             
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
		    		AND ts.physical_inventory IS NOT NULL
		    		GROUP BY
		    		tosp.dealer_product_join_id
		    ) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
        WHERE
            tfs.is_del = 0
            AND tfs.flash_sales_id = 24
            AND tdpj.is_del = 0
            AND tdpj.is_complete = 1
             
             
             
             
        GROUP BY
            tdpj.dealer_product_join_id
        ORDER BY
             
            tdpj.dealer_product_join_id LIMIT 20,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","10.103","0","7655360","20"
"2023-10-27 10:10:46","SELECT COUNT(1) FROM ( SELECT tdpj.dealer_product_join_id, tdpj.dealer_product_join_outer_id, tdpj.dealer_product_name, tdpj.main_cover, IFNULL(topd.count, 0) AS count, stock.physical_inventory AS stock FROM tenant_flash_sales tfs LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id LEFT JOIN (SELECT topd.dealer_product_join_id, COUNT(topd.dealer_product_join_id) AS count FROM tenant_order tor LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id AND topd.is_del = 0 WHERE tor.is_del = 0 AND tor.order_status != 6 GROUP BY topd.dealer_product_join_id) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id LEFT JOIN (SELECT tdpj.dealer_product_join_id, SUM(ts.physical_inventory) AS physical_inventory FROM tenant_dealer_product_join tdpj LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id AND tosp.is_del = 0 LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id WHERE tdpj.is_del = 0 AND ((tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0)) OR (tdpj.has_pick_up = 1 AND tdpj.has_express_delivery = 1 AND ts.warehouse_id IN (SELECT tss.warehouse_id FROM tenant_store ts LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id WHERE ts.is_del = 0 AND tsc.is_del = 0 AND tss.is_del = 0 AND ts.store_inner_id = -1 AND tsc.store_channel_type = 0 UNION SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0)) OR (tdpj.has_pick_up = 1 AND ts.warehouse_id IN (SELECT tspusj.shipper_id AS warehouse_id FROM tenant_self_pick_up_site tspus LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id WHERE tspus.is_del = 0 AND tspus.pick_up_status = 1 AND tspusj.is_del = 0))) AND ts.physical_inventory IS NOT NULL GROUP BY tosp.dealer_product_join_id) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id WHERE tfs.is_del = 0 AND tfs.flash_sales_id = 24 AND tdpj.is_del = 0 AND tdpj.is_complete = 1 GROUP BY tdpj.dealer_product_join_id ORDER BY tdpj.dealer_product_join_id ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","10.07","0","7655468","1"
"2023-10-27 10:10:56","SELECT
            tdpj.dealer_product_join_id,
            tdpj.dealer_product_join_outer_id,
            tdpj.dealer_product_name,
            tdpj.main_cover,
            IFNULL( topd.count, 0 ) AS count,
            stock.physical_inventory AS stock
        FROM
            tenant_flash_sales tfs
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
            LEFT JOIN (
                SELECT
                    topd.dealer_product_join_id,
                    COUNT( topd.dealer_product_join_id ) AS count
                FROM
                    tenant_order tor
                    LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
                    AND topd.is_del = 0
                WHERE
                    tor.is_del = 0
                    AND tor.order_status != 6
                GROUP BY
                    topd.dealer_product_join_id
            ) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		    LEFT JOIN (
		    		SELECT
		    			tdpj.dealer_product_join_id,
		    			SUM( ts.physical_inventory ) AS physical_inventory
		    		FROM
		    			tenant_dealer_product_join tdpj
		    			LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
		    				AND tosp.is_del = 0
		    			LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
		    		WHERE
		    			tdpj.is_del = 0
		    			AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
                                     
                                        AND ts.store_inner_id = -1
                                     
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
                                         
                                                AND ts.store_inner_id = -1
                                             
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
		    		AND ts.physical_inventory IS NOT NULL
		    		GROUP BY
		    		tosp.dealer_product_join_id
		    ) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
        WHERE
            tfs.is_del = 0
            AND tfs.flash_sales_id = 24
            AND tdpj.is_del = 0
            AND tdpj.is_complete = 1
             
             
             
             
        GROUP BY
            tdpj.dealer_product_join_id
        ORDER BY
             
            tdpj.dealer_product_join_id LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","10.065","0","7655340","20"
"2023-10-27 10:14:51","SELECT
            tdpj.dealer_product_join_id,
            tdpj.dealer_product_join_outer_id,
            tdpj.dealer_product_name,
            tdpj.main_cover,
            IFNULL( topd.count, 0 ) AS count,
            stock.physical_inventory AS stock
        FROM
            tenant_flash_sales tfs
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
            LEFT JOIN (
                SELECT
                    topd.dealer_product_join_id,
                    COUNT( topd.dealer_product_join_id ) AS count
                FROM
                    tenant_order tor
                    LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
                    AND topd.is_del = 0
                WHERE
                    tor.is_del = 0
                    AND tor.order_status != 6
                GROUP BY
                    topd.dealer_product_join_id
            ) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		    LEFT JOIN (
		    		SELECT
		    			tdpj.dealer_product_join_id,
		    			SUM( ts.physical_inventory ) AS physical_inventory
		    		FROM
		    			tenant_dealer_product_join tdpj
		    			LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
		    				AND tosp.is_del = 0
		    			LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
		    		WHERE
		    			tdpj.is_del = 0
		    			AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
                                     
                                        AND ts.store_inner_id = -1
                                     
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
                                         
                                                AND ts.store_inner_id = -1
                                             
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
		    		AND ts.physical_inventory IS NOT NULL
		    		GROUP BY
		    		tosp.dealer_product_join_id
		    ) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
        WHERE
            tfs.is_del = 0
            AND tfs.flash_sales_id = 24
            AND tdpj.is_del = 0
            AND tdpj.is_complete = 1
             
             
             
             
        GROUP BY
            tdpj.dealer_product_join_id
        ORDER BY
             
            tdpj.dealer_product_join_id LIMIT 60,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","10.046","0","7655394","14"
"2023-10-27 10:11:17","SELECT
            tdpj.dealer_product_join_id,
            tdpj.dealer_product_join_outer_id,
            tdpj.dealer_product_name,
            tdpj.main_cover,
            IFNULL( topd.count, 0 ) AS count,
            stock.physical_inventory AS stock
        FROM
            tenant_flash_sales tfs
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
            LEFT JOIN (
                SELECT
                    topd.dealer_product_join_id,
                    COUNT( topd.dealer_product_join_id ) AS count
                FROM
                    tenant_order tor
                    LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
                    AND topd.is_del = 0
                WHERE
                    tor.is_del = 0
                    AND tor.order_status != 6
                GROUP BY
                    topd.dealer_product_join_id
            ) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		    LEFT JOIN (
		    		SELECT
		    			tdpj.dealer_product_join_id,
		    			SUM( ts.physical_inventory ) AS physical_inventory
		    		FROM
		    			tenant_dealer_product_join tdpj
		    			LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
		    				AND tosp.is_del = 0
		    			LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
		    		WHERE
		    			tdpj.is_del = 0
		    			AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
                                     
                                        AND ts.store_inner_id = -1
                                     
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
                                         
                                                AND ts.store_inner_id = -1
                                             
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
		    		AND ts.physical_inventory IS NOT NULL
		    		GROUP BY
		    		tosp.dealer_product_join_id
		    ) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
        WHERE
            tfs.is_del = 0
            AND tfs.flash_sales_id = 24
            AND tdpj.is_del = 0
            AND tdpj.is_complete = 1
             
             
             
             
        GROUP BY
            tdpj.dealer_product_join_id
        ORDER BY
             
            tdpj.dealer_product_join_id LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","9.994","0","7655340","20"
"2023-10-29 16:27:04","SELECT
            tudj.join_id                           AS dealer_user_join_id,
            tu.user_union_id                       AS member_union_id,
            IFNULL(tu.user_nickname, tu.user_name) AS member_name,
            tudj.member_card_number                AS member_card_no,
            tu.user_phone                          AS mobile,
            tudj.store_id                          AS belong_store_id,
            ts.store_name                          AS belong_store_name,
            tuaf.flow_type                         AS flow_type,
            tuaf.flow_amount                       AS change_score,
            tuaf.flow_balance                      AS score_after_change,
            tuaf.create_date                       AS happened_date,
            tuaf.remark                            AS remark
        FROM tenant_user_account_flow tuaf
            LEFT JOIN tenant_user_dealer_join tudj ON tudj.user_id = tuaf.user_inner_id
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
        WHERE
            tuaf.is_del=0
            AND tuaf.account_type = 1
             
             
             
             
                AND (tu.user_phone = 'ZYEJ8VML8QDZ06YDJ4Q9'
                    OR tudj.member_card_number = 'ZYEJ8VML8QDZ06YDJ4Q9'
                    OR tu.user_nickname LIKE CONCAT( '%', 'ZYEJ8VML8QDZ06YDJ4Q9', '%' )
                    OR tu.user_name LIKE CONCAT( '%', 'ZYEJ8VML8QDZ06YDJ4Q9', '%' )
                    OR tu.user_union_id= 'ZYEJ8VML8QDZ06YDJ4Q9')
             
             
             
             
        ORDER BY tuaf.user_account_flow_id DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","7.124","0","2431585","3"
"2023-10-29 16:26:57","SELECT COUNT(1) FROM tenant_user_account_flow tuaf LEFT JOIN tenant_user_dealer_join tudj ON tudj.user_id = tuaf.user_inner_id LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id WHERE tuaf.is_del = 0 AND tuaf.account_type = 1 AND (tu.user_phone = 'ZYEJ8VML8QDZ06YDJ4Q9' OR tudj.member_card_number = 'ZYEJ8VML8QDZ06YDJ4Q9' OR tu.user_nickname LIKE CONCAT('%', 'ZYEJ8VML8QDZ06YDJ4Q9', '%') OR tu.user_name LIKE CONCAT('%', 'ZYEJ8VML8QDZ06YDJ4Q9', '%') OR tu.user_union_id = 'ZYEJ8VML8QDZ06YDJ4Q9')","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","6.98","0","2431585","1"
"2023-10-29 19:27:39","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","5.126","0","2373039","20"
"2023-10-27 11:19:13","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","4.938","0","2323061","20"
"2023-10-29 14:04:31","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","4.462","0","2731325","1"
"2023-10-27 11:19:08","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","4.423","0","2696939","1"
"2023-10-29 19:27:33","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","4.36","0","2755175","1"
"2023-10-29 14:42:21","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","4.33","0","2739973","1"
"2023-10-29 14:04:36","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","4.207","0","2352677","20"
"2023-10-29 16:23:08","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","4.195","0","2366476","20"
"2023-10-29 14:03:07","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","4.173","0","2731312","1"
"2023-10-29 19:26:52","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","4.143","0","2755174","1"
"2023-10-29 19:21:49","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","4.123","0","2755156","1"
"2023-10-29 14:39:02","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","4.105","0","2739958","1"
"2023-10-28 14:11:04","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","4.081","0","2722146","1"
"2023-10-29 14:38:06","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","4.059","0","2360009","20"
"2023-10-29 16:23:53","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","4.038","0","2747535","1"
"2023-10-29 19:22:10","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.975","0","2755156","1"
"2023-10-29 16:23:04","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.973","0","2747532","1"
"2023-10-28 15:01:00","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.95","0","2722289","1"
"2023-10-29 15:02:48","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.94","0","2739990","1"
"2023-10-29 20:36:23","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.935","0","2756912","1"
"2023-10-28 14:12:13","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.896","0","2722235","1"
"2023-10-29 14:38:15","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.875","0","2739945","1"
"2023-10-28 14:58:02","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.851","0","2722286","1"
"2023-10-29 15:44:50","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.839","0","2743842","1"
"2023-10-29 14:38:02","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.837","0","2739945","1"
"2023-10-29 14:37:11","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.83","0","2739931","1"
"2023-10-27 11:26:50","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.805","0","2696978","1"
"2023-10-28 14:27:34","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.803","0","2722255","1"
"2023-10-29 19:26:56","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.717","0","2373038","20"
"2023-10-29 14:17:15","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.673","0","2355987","20"
"2023-10-29 15:48:37","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.67","0","2743856","1"
"2023-10-29 14:39:05","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.662","0","2360020","20"
"2023-10-29 19:27:38","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
                AND ( t3.product_outer_id LIKE CONCAT( '%', '3EA632751', '%' ) OR t3.product_name LIKE CONCAT( '%', '3EA632751',
                '%' ) OR t3.third_code LIKE CONCAT( '%', '3EA632751', '%' ) )
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.654","0","2071649","20"
"2023-10-29 14:17:11","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.634","0","2735217","1"
"2023-10-28 14:11:07","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.609","0","2344646","20"
"2023-10-29 19:21:53","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.602","0","2373022","20"
"2023-10-27 11:20:08","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.595","0","2696952","1"
"2023-10-29 20:36:26","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.564","0","2374534","20"
"2023-10-29 19:22:13","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,50","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.534","0","2373052","50"
"2023-10-29 16:23:57","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.522","0","2366479","20"
"2023-10-29 19:27:35","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND (t3.product_outer_id LIKE CONCAT('%', '3EA632751', '%') OR t3.product_name LIKE CONCAT('%', '3EA632751', '%') OR t3.third_code LIKE CONCAT('%', '3EA632751', '%')) AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.483","0","2072085","1"
"2023-10-29 15:02:52","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.449","0","2360050","20"
"2023-10-28 14:58:06","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.444","0","2344770","20"
"2023-10-29 14:04:33","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND (t3.product_outer_id LIKE CONCAT('%', '3EA632261', '%') OR t3.product_name LIKE CONCAT('%', '3EA632261', '%') OR t3.third_code LIKE CONCAT('%', '3EA632261', '%')) AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.439","0","2055722","1"
"2023-10-28 15:01:03","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.439","0","2344773","20"
"2023-10-29 16:23:08","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND (t3.product_outer_id LIKE CONCAT('%', '3E4190531', '%') OR t3.product_name LIKE CONCAT('%', '3E4190531', '%') OR t3.third_code LIKE CONCAT('%', '3E4190531', '%')) AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.404","0","2066934","1"
"2023-10-29 14:03:10","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.403","0","2352677","20"
"2023-10-27 11:19:14","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
                AND ( t3.product_outer_id LIKE CONCAT( '%', '3EA452261  ', '%' ) OR t3.product_name LIKE CONCAT( '%', '3EA452261  ',
                '%' ) OR t3.third_code LIKE CONCAT( '%', '3EA452261  ', '%' ) )
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.402","0","2028795","0"
"2023-10-27 11:20:12","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.387","0","2323072","20"
"2023-10-29 15:48:41","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.385","0","2363344","20"
"2023-10-29 14:37:14","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.384","0","2359997","20"
"2023-10-29 14:42:24","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.381","0","2360033","20"
"2023-10-28 14:27:37","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.369","0","2344741","20"
"2023-10-29 15:44:54","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.355","0","2363332","20"
"2023-10-27 11:19:10","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND (t3.product_outer_id LIKE CONCAT('%', '3EA452261  ', '%') OR t3.product_name LIKE CONCAT('%', '3EA452261  ', '%') OR t3.third_code LIKE CONCAT('%', '3EA452261  ', '%')) AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.348","0","2028795","1"
"2023-10-28 14:12:17","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.34","0","2344723","20"
"2023-10-29 14:38:19","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.317","0","2360009","20"
"2023-10-27 11:26:53","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.282","0","2323094","20"
"2023-10-29 14:38:06","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND (t3.product_outer_id LIKE CONCAT('%', '3EB632941', '%') OR t3.product_name LIKE CONCAT('%', '3EB632941', '%') OR t3.third_code LIKE CONCAT('%', '3EB632941', '%')) AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.245","0","2060365","1"
"2023-10-29 14:04:36","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
                AND ( t3.product_outer_id LIKE CONCAT( '%', '3EA632261', '%' ) OR t3.product_name LIKE CONCAT( '%', '3EA632261',
                '%' ) OR t3.third_code LIKE CONCAT( '%', '3EA632261', '%' ) )
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","3.119","0","2055308","20"
"2023-10-29 19:26:58","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND (t3.product_outer_id LIKE CONCAT('%', '3EA632751', '%') OR t3.product_name LIKE CONCAT('%', '3EA632751', '%') OR t3.third_code LIKE CONCAT('%', '3EA632751', '%')) AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","3.063","0","2072083","1"
"2023-10-29 14:38:09","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
                AND ( t3.product_outer_id LIKE CONCAT( '%', '3EB632941', '%' ) OR t3.product_name LIKE CONCAT( '%', '3EB632941',
                '%' ) OR t3.third_code LIKE CONCAT( '%', '3EB632941', '%' ) )
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.868","0","2060349","16"
"2023-10-29 15:05:23","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
                AND ( t3.product_outer_id LIKE CONCAT( '%', '3EB632941S', '%' ) OR t3.product_name LIKE CONCAT( '%', '3EB632941S',
                '%' ) OR t3.third_code LIKE CONCAT( '%', '3EB632941S', '%' ) )
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.865","0","2061583","16"
"2023-10-29 16:23:11","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
                AND ( t3.product_outer_id LIKE CONCAT( '%', '3E4190531', '%' ) OR t3.product_name LIKE CONCAT( '%', '3E4190531',
                '%' ) OR t3.third_code LIKE CONCAT( '%', '3E4190531', '%' ) )
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.826","0","2066332","20"
"2023-10-29 16:24:32","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.762","0","777557","101239"
"2023-10-29 22:14:20","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.747","0","777557","101239"
"2023-10-29 16:24:33","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.742","0","777557","101239"
"2023-10-29 15:05:20","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND (t3.product_outer_id LIKE CONCAT('%', '3EB632941S', '%') OR t3.product_name LIKE CONCAT('%', '3EB632941S', '%') OR t3.third_code LIKE CONCAT('%', '3EB632941S', '%')) AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.681","0","2061503","1"
"2023-10-27 11:19:51","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND (t3.product_outer_id LIKE CONCAT('%', '3EA452261  ', '%') OR t3.product_name LIKE CONCAT('%', '3EA452261  ', '%') OR t3.third_code LIKE CONCAT('%', '3EA452261  ', '%')) AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.672","0","2028803","1"
"2023-10-29 19:27:00","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
                AND ( t3.product_outer_id LIKE CONCAT( '%', '3EA632751', '%' ) OR t3.product_name LIKE CONCAT( '%', '3EA632751',
                '%' ) OR t3.third_code LIKE CONCAT( '%', '3EA632751', '%' ) )
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.649","0","2071647","20"
"2023-10-28 21:20:02","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.642","0","777557","101239"
"2023-10-27 11:56:42","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.603","0","777557","101239"
"2023-10-29 16:26:35","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.601","0","777557","101239"
"2023-10-29 15:08:38","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.588","0","777557","101239"
"2023-10-29 13:49:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.585","0","777557","101239"
"2023-10-29 21:45:17","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.583","0","777557","101239"
"2023-10-27 11:19:44","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
                AND ( t3.product_outer_id LIKE CONCAT( '%', '3EA452261  ', '%' ) OR t3.product_name LIKE CONCAT( '%', '3EA452261  ',
                '%' ) OR t3.third_code LIKE CONCAT( '%', '3EA452261  ', '%' ) )
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.581","0","2028803","0"
"2023-10-29 14:13:47","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.567","0","777557","101239"
"2023-10-29 15:13:26","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.563","0","777557","101239"
"2023-10-27 11:19:41","SELECT COUNT(1) FROM ( SELECT t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId, t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId, t4.warehouse_name AS warehouseName, t1.warehouse_receipt_type AS warehouseReceiptType, t1.receipt_status AS receiptStatus, t5.tea_name AS teaName, t1.create_date AS createDate, t1.receipt_date AS receiptDate FROM tenant_warehouse_receipt t1 LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id AND t2.is_del = 0 LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id AND t4.is_del = 0 LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id WHERE t1.is_del = 0 AND (t3.product_outer_id LIKE CONCAT('%', '3EA452261  ', '%') OR t3.product_name LIKE CONCAT('%', '3EA452261  ', '%') OR t3.third_code LIKE CONCAT('%', '3EA452261  ', '%')) AND t1.send_warehouse_id = -1 GROUP BY t1.warehouse_receipt_inner_id ORDER BY t1.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.561","0","2028803","1"
"2023-10-29 16:26:35","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.547","0","777557","101239"
"2023-10-29 20:30:35","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.546","0","777557","101239"
"2023-10-29 19:00:02","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.546","0","777557","101239"
"2023-10-27 11:19:54","SELECT
        t1.warehouse_receipt_inner_id AS warehouseReceiptInnerId,
        t1.warehouse_receipt_outer_id AS warehouseReceiptOuterId,
        t4.warehouse_name AS warehouseName,
        t1.warehouse_receipt_type AS warehouseReceiptType,
        t1.receipt_status AS receiptStatus,
        t5.tea_name AS teaName,
        t1.create_date AS createDate,
        t1.receipt_date AS receiptDate
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_warehouse_receipt_detail t2 ON t1.warehouse_receipt_inner_id = t2.warehouse_receipt_id
        AND t2.is_del = 0
        LEFT JOIN tenant_product t3 ON t2.product_id = t3.product_inner_id
         
                INNER JOIN tenant_warehouse t4 ON t1.receive_warehouse_id = t4.warehouse_inner_id
                AND t4.is_del = 0
             
        LEFT JOIN tenant_employee_account t5 ON t1.create_user = t5.tea_id
        LEFT JOIN tenant_purchase_order t6 ON t1.related_id = t6.purchase_order_inner_id
        LEFT JOIN tenant_purchase_return_order t7 ON t1.related_id = t7.purchase_return_order_inner_id
        LEFT JOIN tenant_requisition t8 ON t1.related_id = t8.requisition_inner_id
        LEFT JOIN tenant_check_stock_order t9 ON t1.related_id = t9.check_stock_order_inner_id
        LEFT JOIN tenant_order t10 ON t1.related_id = t10.order_inner_id
         WHERE t1.is_del = 0
            
                AND ( t3.product_outer_id LIKE CONCAT( '%', '3EA452261  ', '%' ) OR t3.product_name LIKE CONCAT( '%', '3EA452261  ',
                '%' ) OR t3.third_code LIKE CONCAT( '%', '3EA452261  ', '%' ) )
            
            
            
            
            
            
            
            
            
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.warehouse_receipt_inner_id
        ORDER BY
        t1.create_date DESC","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.539","0","2028803","0"
"2023-10-29 13:19:05","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.538","0","777557","101239"
"2023-10-27 17:10:22","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.537","0","777557","101239"
"2023-10-29 14:29:04","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.533","0","777557","101239"
"2023-10-29 21:43:23","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.532","0","777557","101239"
"2023-10-29 15:29:12","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.525","0","777557","101239"
"2023-10-28 22:00:33","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.519","0.001","777557","101239"
"2023-10-27 11:38:55","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.503","0","777557","101239"
"2023-10-29 14:12:58","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.502","0","777557","101239"
"2023-10-29 13:12:40","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.501","0","777557","101239"
"2023-10-29 19:33:44","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.501","0","777557","101239"
"2023-10-29 14:29:28","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.496","0","777557","101239"
"2023-10-28 20:37:43","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.493","0","777557","101239"
"2023-10-28 20:37:43","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.492","0.001","777557","101239"
"2023-10-29 16:18:01","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.492","0","777557","101239"
"2023-10-27 17:13:19","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.491","0","777557","101239"
"2023-10-29 16:32:16","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.49","0","777557","101239"
"2023-10-27 15:31:03","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.489","0","777557","101239"
"2023-10-29 14:38:39","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.488","0","777557","101239"
"2023-10-29 15:20:35","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.487","0","777557","101239"
"2023-10-28 18:18:26","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.483","0","777557","101239"
"2023-10-29 15:31:09","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.482","0","777557","101239"
"2023-10-28 17:46:21","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.465","0","777557","101239"
"2023-10-27 17:11:15","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.465","0","777557","101239"
"2023-10-27 15:07:47","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.464","0","777557","101239"
"2023-10-27 14:56:52","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.461","0","777557","101239"
"2023-10-27 11:38:34","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.46","0","777557","101239"
"2023-10-27 12:22:47","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.455","0","777557","101239"
"2023-10-27 13:23:58","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.453","0","777557","101239"
"2023-10-29 18:15:39","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.451","0","777557","101239"
"2023-10-29 12:03:58","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.451","0","777557","101239"
"2023-10-28 13:35:48","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.448","0","777557","101239"
"2023-10-28 21:31:05","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.445","0","777557","101239"
"2023-10-27 11:15:26","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.445","0","777557","101239"
"2023-10-28 21:16:22","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.445","0","777557","101239"
"2023-10-29 15:54:11","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.444","0","777557","101239"
"2023-10-28 23:24:55","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.444","0","777557","101239"
"2023-10-29 19:36:13","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.44","0","777557","101239"
"2023-10-28 19:28:56","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.44","0","777557","101239"
"2023-10-28 16:53:15","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.439","0","777557","101239"
"2023-10-28 08:54:47","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.437","0","777557","101239"
"2023-10-28 10:10:36","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.436","0","777557","101239"
"2023-10-27 21:49:18","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.436","0","777557","101239"
"2023-10-28 15:57:57","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.435","0","777557","101239"
"2023-10-28 13:27:09","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.435","0","777557","101239"
"2023-10-29 18:45:05","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.434","0","777557","101239"
"2023-10-29 15:34:22","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.433","0","777557","101239"
"2023-10-27 15:51:50","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.432","0","777557","101239"
"2023-10-28 16:34:32","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.431","0","777557","101239"
"2023-10-28 20:05:32","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.431","0","777557","101239"
"2023-10-29 20:28:35","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.43","0","777557","101239"
"2023-10-28 19:41:31","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.43","0","777557","101239"
"2023-10-28 16:38:31","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.428","0","777557","101239"
"2023-10-27 11:37:49","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.427","0","777557","101239"
"2023-10-29 17:30:12","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.426","0","777557","101239"
"2023-10-27 11:23:44","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.426","0","777557","101239"
"2023-10-29 22:00:34","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.426","0","777557","101239"
"2023-10-29 15:14:21","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.425","0","777557","101239"
"2023-10-28 18:31:50","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.425","0","777557","101239"
"2023-10-28 18:08:44","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.424","0","777557","101239"
"2023-10-28 17:00:14","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.423","0","777557","101239"
"2023-10-27 22:19:33","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.423","0","777557","101239"
"2023-10-27 22:04:33","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.422","0","777557","101239"
"2023-10-28 19:28:35","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.422","0","777557","101239"
"2023-10-27 09:34:06","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.422","0","777557","101239"
"2023-10-28 21:44:44","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.421","0","777557","101239"
"2023-10-27 16:39:02","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.421","0","777557","101239"
"2023-10-27 19:13:24","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.421","0","777557","101239"
"2023-10-29 14:25:13","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.42","0","777557","101239"
"2023-10-28 18:41:16","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.42","0","777557","101239"
"2023-10-29 10:10:26","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.42","0","777557","101239"
"2023-10-27 12:25:27","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.42","0","777557","101239"
"2023-10-27 16:09:18","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.419","0","777557","101239"
"2023-10-27 11:13:51","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.418","0","777557","101239"
"2023-10-28 19:20:18","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.417","0","777557","101239"
"2023-10-28 15:58:55","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.416","0","777557","101239"
"2023-10-28 19:34:16","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.416","0","777557","101239"
"2023-10-29 20:37:40","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.416","0","777557","101239"
"2023-10-29 14:19:52","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.415","0","777557","101239"
"2023-10-29 19:59:41","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.415","0","777557","101239"
"2023-10-27 21:15:57","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.414","0","777557","101239"
"2023-10-28 13:48:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.413","0","777557","101239"
"2023-10-29 13:09:37","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.413","0","777557","101239"
"2023-10-28 16:41:10","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.413","0","777557","101239"
"2023-10-27 19:03:07","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.412","0","777557","101239"
"2023-10-28 17:11:01","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.412","0","777557","101239"
"2023-10-29 16:23:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.411","0","777557","101239"
"2023-10-29 15:04:45","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.411","0","777557","101239"
"2023-10-28 20:36:48","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.411","0","777557","101239"
"2023-10-28 18:09:45","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.411","0","777557","101239"
"2023-10-29 20:36:38","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.41","0","777557","101239"
"2023-10-28 21:10:12","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.41","0","777557","101239"
"2023-10-28 21:10:09","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.41","0","777557","101239"
"2023-10-27 15:51:10","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.409","0","777557","101239"
"2023-10-29 18:52:53","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.409","0","777557","101239"
"2023-10-28 19:35:59","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.408","0","777557","101239"
"2023-10-27 14:36:21","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.408","0","777557","101239"
"2023-10-28 18:08:57","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.408","0","777557","101239"
"2023-10-29 09:24:49","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.407","0","777557","101239"
"2023-10-29 12:07:54","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.407","0","777557","101239"
"2023-10-28 18:59:54","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.407","0","777557","101239"
"2023-10-28 16:32:59","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.407","0","777557","101239"
"2023-10-27 21:08:20","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.406","0","777557","101239"
"2023-10-28 12:21:11","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.406","0","777557","101239"
"2023-10-27 17:51:51","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.406","0","777557","101239"
"2023-10-29 01:04:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.405","0","777557","101239"
"2023-10-28 22:49:59","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.404","0","777557","101239"
"2023-10-29 15:10:23","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.404","0","777557","101239"
"2023-10-28 17:09:08","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.403","0","777557","101239"
"2023-10-27 17:09:26","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.402","0","777557","101239"
"2023-10-29 22:09:16","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.402","0","777557","101239"
"2023-10-28 20:00:45","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.401","0","777557","101239"
"2023-10-29 15:11:49","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.401","0","777557","101239"
"2023-10-28 20:42:11","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.401","0","777557","101239"
"2023-10-28 19:26:19","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.401","0","777557","101239"
"2023-10-28 14:45:42","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.401","0","777557","101239"
"2023-10-28 22:57:11","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.4","0","777557","101239"
"2023-10-28 15:53:36","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.4","0","777557","101239"
"2023-10-27 17:23:24","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.399","0","777557","101239"
"2023-10-28 22:56:12","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.398","0","777557","101239"
"2023-10-28 17:49:29","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.398","0","777557","101239"
"2023-10-29 16:31:15","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.397","0","777557","101239"
"2023-10-28 11:04:15","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.397","0","777557","101239"
"2023-10-29 17:59:02","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.396","0","777557","101239"
"2023-10-27 22:19:47","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.396","0","777557","101239"
"2023-10-27 18:08:48","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.395","0","777557","101239"
"2023-10-29 15:54:45","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.395","0","777557","101239"
"2023-10-28 15:16:46","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.395","0","777557","101239"
"2023-10-28 19:41:41","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.394","0","777557","101239"
"2023-10-29 16:28:24","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.394","0","777557","101239"
"2023-10-28 17:59:48","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.393","0","777557","101239"
"2023-10-28 16:37:31","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.393","0","777557","101239"
"2023-10-27 20:08:18","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.393","0","777557","101239"
"2023-10-27 21:38:02","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.393","0","777557","101239"
"2023-10-29 20:22:11","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.392","0","777557","101239"
"2023-10-28 19:24:24","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.392","0","777557","101239"
"2023-10-29 16:10:11","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.392","0","777557","101239"
"2023-10-27 19:39:14","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.391","0","777557","101239"
"2023-10-28 12:25:14","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.391","0","777557","101239"
"2023-10-27 21:38:15","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.391","0","777557","101239"
"2023-10-28 15:10:49","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.391","0","777557","101239"
"2023-10-29 01:04:24","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.39","0","777557","101239"
"2023-10-29 18:32:37","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.39","0","777557","101239"
"2023-10-29 14:29:26","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.39","0","777557","101239"
"2023-10-27 12:20:09","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.39","0","777557","101239"
"2023-10-28 21:12:12","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.39","0","777557","101239"
"2023-10-28 16:00:49","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.39","0","777557","101239"
"2023-10-29 15:54:22","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.389","0","777557","101239"
"2023-10-28 18:26:21","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.389","0","777557","101239"
"2023-10-28 17:37:51","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.389","0","777557","101239"
"2023-10-28 19:09:51","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.389","0","777557","101239"
"2023-10-29 21:18:08","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.389","0","777557","101239"
"2023-10-27 15:51:58","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.388","0","777557","101239"
"2023-10-28 19:38:38","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.388","0","777557","101239"
"2023-10-29 07:34:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.388","0","777557","101239"
"2023-10-28 19:11:14","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.387","0","777557","101239"
"2023-10-28 00:13:08","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.386","0","777557","101239"
"2023-10-28 18:38:17","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.385","0","777557","101239"
"2023-10-28 20:52:32","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.385","0","777557","101239"
"2023-10-27 15:37:10","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.384","0","777557","101239"
"2023-10-28 12:31:40","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.384","0","777557","101239"
"2023-10-27 14:15:57","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.383","0","777557","101239"
"2023-10-28 18:13:57","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.383","0","777557","101239"
"2023-10-28 11:10:56","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.383","0","777557","101239"
"2023-10-27 15:42:27","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.382","0","777557","101239"
"2023-10-29 13:27:17","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.382","0","777557","101239"
"2023-10-27 09:33:57","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.382","0","777557","101239"
"2023-10-27 12:18:48","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.381","0","777557","101239"
"2023-10-29 12:50:40","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.381","0","777557","101239"
"2023-10-28 18:34:41","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.381","0","777557","101239"
"2023-10-28 13:57:45","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.381","0","777557","101239"
"2023-10-27 08:20:33","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.381","0","777557","101239"
"2023-10-28 13:42:31","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.381","0","777557","101239"
"2023-10-27 15:11:31","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.38","0","777557","101239"
"2023-10-29 19:50:56","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.38","0","777557","101239"
"2023-10-29 15:22:50","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.379","0","777557","101239"
"2023-10-27 11:46:42","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.379","0","777557","101239"
"2023-10-28 00:09:56","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.379","0","777557","101239"
"2023-10-28 15:53:30","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.379","0","777557","101239"
"2023-10-28 15:18:43","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.378","0","777557","101239"
"2023-10-27 21:32:39","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.378","0","777557","101239"
"2023-10-27 20:42:49","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.378","0","777557","101239"
"2023-10-27 12:53:15","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.378","0","777557","101239"
"2023-10-28 00:22:56","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.378","0","777557","101239"
"2023-10-29 19:09:45","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.377","0","777557","101239"
"2023-10-28 12:22:42","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.377","0","777557","101239"
"2023-10-29 23:58:15","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.377","0","777557","101239"
"2023-10-27 09:41:58","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.377","0","777557","101239"
"2023-10-28 14:18:46","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.376","0","777557","101239"
"2023-10-27 22:19:52","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.376","0","777557","101239"
"2023-10-28 19:37:25","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.376","0","777557","101239"
"2023-10-29 16:12:21","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.376","0","777557","101239"
"2023-10-27 20:58:22","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.376","0","777557","101239"
"2023-10-29 13:27:27","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.376","0","777557","101239"
"2023-10-28 09:29:56","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.376","0","777557","101239"
"2023-10-29 12:28:13","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.376","0","777557","101239"
"2023-10-27 15:53:11","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.375","0","777557","101239"
"2023-10-28 19:08:25","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.375","0","777557","101239"
"2023-10-27 19:59:26","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.374","0","777557","101239"
"2023-10-28 21:57:28","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.374","0","777557","101239"
"2023-10-28 14:30:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.374","0","777557","101239"
"2023-10-27 11:23:49","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.374","0","777557","101239"
"2023-10-27 19:16:16","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.373","0","777557","101239"
"2023-10-27 22:12:41","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.373","0","777557","101239"
"2023-10-28 18:13:34","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.373","0","777557","101239"
"2023-10-27 11:22:57","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.373","0","777557","101239"
"2023-10-29 15:14:53","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.373","0","777557","101239"
"2023-10-29 20:25:16","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.373","0","777557","101239"
"2023-10-28 19:36:26","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.372","0","777557","101239"
"2023-10-29 12:28:26","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.372","0","777557","101239"
"2023-10-29 12:28:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.372","0","777557","101239"
"2023-10-28 20:43:06","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.371","0","777557","101239"
"2023-10-29 19:48:42","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.371","0","777557","101239"
"2023-10-28 21:17:37","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.371","0","777557","101239"
"2023-10-28 11:10:51","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.371","0","777557","101239"
"2023-10-29 17:46:42","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.37","0","777557","101239"
"2023-10-27 18:46:09","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.37","0","777557","101239"
"2023-10-28 08:49:54","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.37","0","777557","101239"
"2023-10-28 21:33:17","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.368","0","777557","101239"
"2023-10-28 15:09:05","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.368","0","777557","101239"
"2023-10-28 21:10:17","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.368","0.001","777557","101239"
"2023-10-27 15:02:27","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.368","0","777557","101239"
"2023-10-29 16:21:47","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.366","0","777557","101239"
"2023-10-28 17:40:21","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.366","0","777557","101239"
"2023-10-28 16:33:53","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.365","0","777557","101239"
"2023-10-29 07:37:41","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.365","0","777557","101239"
"2023-10-28 20:14:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.364","0","777557","101239"
"2023-10-28 10:11:54","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.364","0","777557","101239"
"2023-10-28 07:33:09","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.364","0","777557","101239"
"2023-10-27 15:42:16","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.364","0","777557","101239"
"2023-10-27 15:47:08","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.363","0","777557","101239"
"2023-10-28 08:54:44","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.363","0","777557","101239"
"2023-10-28 16:54:21","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.363","0","777557","101239"
"2023-10-27 18:09:20","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.362","0","777557","101239"
"2023-10-27 18:15:52","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.362","0","777557","101239"
"2023-10-27 18:46:05","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.362","0","777557","101239"
"2023-10-27 14:36:24","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.362","0","777557","101239"
"2023-10-27 00:07:08","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.362","0","777557","101239"
"2023-10-27 21:58:39","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.361","0","777557","101239"
"2023-10-28 19:12:50","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.36","0","777557","101239"
"2023-10-29 19:41:47","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.36","0","777557","101239"
"2023-10-29 15:30:49","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.359","0","777557","101239"
"2023-10-29 11:13:28","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.358","0","777557","101239"
"2023-10-27 16:22:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.356","0","777557","101239"
"2023-10-29 10:19:50","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.356","0","777557","101239"
"2023-10-28 11:24:25","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.355","0","777557","101239"
"2023-10-29 12:38:20","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.355","0","777557","101239"
"2023-10-27 16:24:44","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.353","0","777557","101239"
"2023-10-27 01:11:53","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.353","0","777557","101239"
"2023-10-29 08:28:32","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.353","0","777557","101239"
"2023-10-28 14:51:34","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.352","0","777557","101239"
"2023-10-27 12:11:00","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.352","0","777557","101239"
"2023-10-29 01:02:45","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.351","0","777557","101239"
"2023-10-27 18:12:22","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.351","0","777557","101239"
"2023-10-28 10:13:49","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.35","0","777557","101239"
"2023-10-29 19:11:07","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.35","0","777557","101239"
"2023-10-29 16:23:29","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.348","0","777557","101239"
"2023-10-28 08:44:47","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.348","0","777557","101239"
"2023-10-29 20:03:06","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.347","0","777557","101239"
"2023-10-29 12:11:23","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.346","0","777557","101239"
"2023-10-29 08:40:56","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.346","0","777557","101239"
"2023-10-29 08:22:48","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.344","0","777557","101239"
"2023-10-27 22:12:10","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.342","0","777557","101239"
"2023-10-27 18:58:42","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.34","0","777557","101239"
"2023-10-27 18:52:47","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.335","0","777557","101239"
"2023-10-29 09:24:59","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","2.334","0","777557","101239"
"2023-10-27 15:08:19","SELECT
            t1.self_pick_up_site_id,
            t1.pick_up_attribute,
            t1.store_outer_id,
            t1.pick_up_name,
            t1.province_code,
            t1.city_code,
            t1.district_code,
            t1.longitude,
            t1.latitude,
            t1.address,
            t1.distance,
            t1.shipperstore_inner_id,
            t1.shipperstore_outer_id,
            t1.shipperstore_name,
            t1.shipperlongitude,
            t1.shipperlatitude,
            t1.shipperstoreAddress,
            t1.shipperdistance,
            t1.shipperwarehouse_is_express,
            t1.shipperwarehouse_is_pick_up,
            t1.shipperwarehouse_is_city_delivery
        FROM
            (
                SELECT
                    tspus.self_pick_up_site_id,
                    tspus.pick_up_attribute,
                    ts.store_outer_id,
                    tspus.pick_up_name,
                    tspus.province_code,
                    tspus.city_code,
                    tspus.district_code,
                    tspus.longitude,
                    tspus.latitude,
                    tspus.address,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - tspus.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( tspus.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - tspus.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS distance,
                    shipperts.store_inner_id AS shipperstore_inner_id,
                    shipperts.store_outer_id AS shipperstore_outer_id,
                    shipperts.store_name AS shipperstore_name,
                    shipperts.longitude AS shipperlongitude,
                    shipperts.latitude AS shipperlatitude,
                    shipperts.store_address AS shipperstoreAddress,
                    ROUND( 6371 * 2 * ASIN( SQRT(
                    POW( SIN( ( 0 * PI() / 180 - shipperts.latitude * PI() / 180 ) / 2 ), 2 ) -- 纬度
                    + COS( 0 * PI() / 180 ) -- 纬度
                    * COS( shipperts.latitude * PI() / 180 ) -- 纬度
                    * POW( SIN( ( 0 * PI() / 180 - shipperts.longitude * PI() / 180 ) / 2 ), 2 ) -- 经度
                    ) ) * 1000 -- 米
                    , 2 ) AS shipperdistance,
                    shippertw.warehouse_is_express AS shipperwarehouse_is_express,
                    shippertw.warehouse_is_pick_up AS shipperwarehouse_is_pick_up,
                    shippertw.warehouse_is_city_delivery AS shipperwarehouse_is_city_delivery
                FROM
                    tenant_self_pick_up_site tspus
                    LEFT JOIN tenant_warehouse tw ON tspus.pick_up_warehouse_id = tw.warehouse_inner_id
                    AND tw.is_del = 0
                    LEFT JOIN tenant_store ts ON tw.warehouse_store_id = ts.store_inner_id
                    AND ts.is_del = 0
                    LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
                    AND tspusj.is_del = 0
                    LEFT JOIN tenant_warehouse shippertw ON tspusj.shipper_id = shippertw.warehouse_inner_id
                    AND shippertw.is_del = 0
                    LEFT JOIN tenant_stock_share tss ON shippertw.warehouse_inner_id = tss.warehouse_id
                    AND tss.is_del = 0
                    LEFT JOIN tenant_store shipperts ON tss.store_id = shipperts.store_inner_id
                    AND shipperts.is_del = 0
                     
                 WHERE tspus.is_del = 0
                    AND tspus.pick_up_status = 1 
                GROUP BY
                    tspus.self_pick_up_site_id,
                    shipperts.store_inner_id
            ) t1
        WHERE
            t1.distance IS NOT NULL
            AND t1.shipperdistance IS NOT NULL
        ORDER BY
            t1.distance,
            t1.shipperdistance","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.328","0","777557","101239"
"2023-10-28 22:20:53","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 388315
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18698571143', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","2.307","0","915884","1"
"2023-10-27 14:00:24","SELECT
			tdpj.dealer_product_join_id,
			tdpj.dealer_product_join_outer_id,
			tdpj.dealer_product_name,
			tdpj.main_cover,
			IFNULL( topd.count, 0 ) AS count,
			IFNULL( stock.physical_inventory, 0 ) AS stock
		FROM
			tenant_flash_sales tfs
			LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
			LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
			LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
			LEFT JOIN (
				SELECT
					topd.dealer_product_join_id,
					COUNT( topd.dealer_product_join_id ) AS count
				FROM
					tenant_order tor
					LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
					AND topd.is_del = 0
				WHERE
					tor.is_del = 0
					AND tor.order_status != 6
				GROUP BY
					topd.dealer_product_join_id
			) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		LEFT JOIN (
				SELECT
					tdpj.dealer_product_join_id,
					SUM( ts.physical_inventory ) AS physical_inventory
				FROM
					tenant_dealer_product_join tdpj
					LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
						AND tosp.is_del = 0
					LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
				WHERE
					tdpj.is_del = 0
					 AND tdpj.dealer_product_join_id IN (  
						27508282316752
					 , 
						27841794572368
					 , 
						27508415444416
					 , 
						27508421913040
					 , 
						27508318991376
					 , 
						27508195803520
					 , 
						27508372339840
					 , 
						27841782902832
					 , 
						27508122148800
					 , 
						27264593889344
					 , 
						27508140015856
					 , 
						27508184049488
					 , 
						27508344340032
					 , 
						27841975021168
					 , 
						27508160046896
					 , 
						27841899206112
					 , 
						27508314023680
					 , 
						27508223356080
					 , 
						27508340625712
					 , 
						27508135952608
					 , 
						27841820523872
					 , 
						27841833713792
					 , 
						27841859230096
					 , 
						27841869729472
					 , 
						27841880851152
					 , 
						27841928946208
					 , 
						27841960594752
					 , 
						27841983181952
					 , 
						27842311138352
					 , 
						27842312848448
					 , 
						28109544281664
					 , 
						28109760657392
					 , 
						28109676642880
					 , 
						28109553912672
					 , 
						28109643204384
					 , 
						28109766932224
					 , 
						28109556557936
					 , 
						28109593854640
					 , 
						28109600650432
					 , 
						28109619253712
					 , 
						28109630936032
					 , 
						28109588554640
					 , 
						28109685632368
					 , 
						28110033679904
					 , 
						28109754952672
					 , 
						28109697397120
					 , 
						27508320461856
					 , 
						28110038312768
					 , 
						28109633500416
					 , 
						28109637828368
					 , 
						28110048644432
					 , 
						27508228684480
					 , 
						27508300690160
					 , 
						27508221444000
					 , 
						27508426970080
					 , 
						27508186874992
					 , 
						28109726803360
					 , 
						28109681030992
					 , 
						28109549423696
					 , 
						28616959653760
					 , 
						28616962695568
					 , 
						28616964710320
					 , 
						27508185959008
					 , 
						27508107240352
					 , 
						27508103690128
					 , 
						27572419116720
					 ) 
					AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
									 
											AND ts.store_inner_id = -1
										 
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
										 
												AND ts.store_inner_id = -1
											 
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
				AND ts.physical_inventory IS NOT NULL
				GROUP BY
				tosp.dealer_product_join_id
			) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
		WHERE
			tfs.is_del = 0
			AND tfs.flash_sales_id = 24
			AND tdpj.is_del = 0
			AND tdpj.is_complete = 1
			 
			 
		  	 
			 AND tdpj.dealer_product_join_id IN (  
				27508282316752
			 , 
				27841794572368
			 , 
				27508415444416
			 , 
				27508421913040
			 , 
				27508318991376
			 , 
				27508195803520
			 , 
				27508372339840
			 , 
				27841782902832
			 , 
				27508122148800
			 , 
				27264593889344
			 , 
				27508140015856
			 , 
				27508184049488
			 , 
				27508344340032
			 , 
				27841975021168
			 , 
				27508160046896
			 , 
				27841899206112
			 , 
				27508314023680
			 , 
				27508223356080
			 , 
				27508340625712
			 , 
				27508135952608
			 , 
				27841820523872
			 , 
				27841833713792
			 , 
				27841859230096
			 , 
				27841869729472
			 , 
				27841880851152
			 , 
				27841928946208
			 , 
				27841960594752
			 , 
				27841983181952
			 , 
				27842311138352
			 , 
				27842312848448
			 , 
				28109544281664
			 , 
				28109760657392
			 , 
				28109676642880
			 , 
				28109553912672
			 , 
				28109643204384
			 , 
				28109766932224
			 , 
				28109556557936
			 , 
				28109593854640
			 , 
				28109600650432
			 , 
				28109619253712
			 , 
				28109630936032
			 , 
				28109588554640
			 , 
				28109685632368
			 , 
				28110033679904
			 , 
				28109754952672
			 , 
				28109697397120
			 , 
				27508320461856
			 , 
				28110038312768
			 , 
				28109633500416
			 , 
				28109637828368
			 , 
				28110048644432
			 , 
				27508228684480
			 , 
				27508300690160
			 , 
				27508221444000
			 , 
				27508426970080
			 , 
				27508186874992
			 , 
				28109726803360
			 , 
				28109681030992
			 , 
				28109549423696
			 , 
				28616959653760
			 , 
				28616962695568
			 , 
				28616964710320
			 , 
				27508185959008
			 , 
				27508107240352
			 , 
				27508103690128
			 , 
				27572419116720
			 ) 
		GROUP BY
			tdpj.dealer_product_join_id
		ORDER BY
		     
					 FIELD ( tdpj.dealer_product_join_id,   
						27508282316752
					 , 
						27841794572368
					 , 
						27508415444416
					 , 
						27508421913040
					 , 
						27508318991376
					 , 
						27508195803520
					 , 
						27508372339840
					 , 
						27841782902832
					 , 
						27508122148800
					 , 
						27264593889344
					 , 
						27508140015856
					 , 
						27508184049488
					 , 
						27508344340032
					 , 
						27841975021168
					 , 
						27508160046896
					 , 
						27841899206112
					 , 
						27508314023680
					 , 
						27508223356080
					 , 
						27508340625712
					 , 
						27508135952608
					 , 
						27841820523872
					 , 
						27841833713792
					 , 
						27841859230096
					 , 
						27841869729472
					 , 
						27841880851152
					 , 
						27841928946208
					 , 
						27841960594752
					 , 
						27841983181952
					 , 
						27842311138352
					 , 
						27842312848448
					 , 
						28109544281664
					 , 
						28109760657392
					 , 
						28109676642880
					 , 
						28109553912672
					 , 
						28109643204384
					 , 
						28109766932224
					 , 
						28109556557936
					 , 
						28109593854640
					 , 
						28109600650432
					 , 
						28109619253712
					 , 
						28109630936032
					 , 
						28109588554640
					 , 
						28109685632368
					 , 
						28110033679904
					 , 
						28109754952672
					 , 
						28109697397120
					 , 
						27508320461856
					 , 
						28110038312768
					 , 
						28109633500416
					 , 
						28109637828368
					 , 
						28110048644432
					 , 
						27508228684480
					 , 
						27508300690160
					 , 
						27508221444000
					 , 
						27508426970080
					 , 
						27508186874992
					 , ","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","2.271","0.001","476362","66"
"2023-10-27 13:42:19","SELECT
			tdpj.dealer_product_join_id,
			tdpj.dealer_product_join_outer_id,
			tdpj.dealer_product_name,
			tdpj.main_cover,
			IFNULL( topd.count, 0 ) AS count,
			IFNULL( stock.physical_inventory, 0 ) AS stock
		FROM
			tenant_flash_sales tfs
			LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
			LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
			LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
			LEFT JOIN (
				SELECT
					topd.dealer_product_join_id,
					COUNT( topd.dealer_product_join_id ) AS count
				FROM
					tenant_order tor
					LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
					AND topd.is_del = 0
				WHERE
					tor.is_del = 0
					AND tor.order_status != 6
				GROUP BY
					topd.dealer_product_join_id
			) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		LEFT JOIN (
				SELECT
					tdpj.dealer_product_join_id,
					SUM( ts.physical_inventory ) AS physical_inventory
				FROM
					tenant_dealer_product_join tdpj
					LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
						AND tosp.is_del = 0
					LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
				WHERE
					tdpj.is_del = 0
					 AND tdpj.dealer_product_join_id IN (  
						27508282316752
					 , 
						27841794572368
					 , 
						27508415444416
					 , 
						27508421913040
					 , 
						27508318991376
					 , 
						27508195803520
					 , 
						27508372339840
					 , 
						27841782902832
					 , 
						27508122148800
					 , 
						27264593889344
					 , 
						27508140015856
					 , 
						27508184049488
					 , 
						27508344340032
					 , 
						27841975021168
					 , 
						27508160046896
					 , 
						27841899206112
					 , 
						27508314023680
					 , 
						27508223356080
					 , 
						27508340625712
					 , 
						27508135952608
					 , 
						27841820523872
					 , 
						27841833713792
					 , 
						27841859230096
					 , 
						27841869729472
					 , 
						27841880851152
					 , 
						27841928946208
					 , 
						27841960594752
					 , 
						27841983181952
					 , 
						27842311138352
					 , 
						27842312848448
					 , 
						28109544281664
					 , 
						28109760657392
					 , 
						28109676642880
					 , 
						28109553912672
					 , 
						28109643204384
					 , 
						28109766932224
					 , 
						28109556557936
					 , 
						28109593854640
					 , 
						28109600650432
					 , 
						28109619253712
					 , 
						28109630936032
					 , 
						28109588554640
					 , 
						28109685632368
					 , 
						28110033679904
					 , 
						28109754952672
					 , 
						28109697397120
					 , 
						27508320461856
					 , 
						28110038312768
					 , 
						28109633500416
					 , 
						28109637828368
					 , 
						28110048644432
					 , 
						27508228684480
					 , 
						27508300690160
					 , 
						27508221444000
					 , 
						27508426970080
					 , 
						27508186874992
					 , 
						28109726803360
					 , 
						28109681030992
					 , 
						28109549423696
					 , 
						28616959653760
					 , 
						28616962695568
					 , 
						28616964710320
					 , 
						27508185959008
					 , 
						27508107240352
					 , 
						27508103690128
					 , 
						27572419116720
					 ) 
					AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
									 
											AND ts.store_inner_id = -1
										 
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
										 
												AND ts.store_inner_id = -1
											 
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
				AND ts.physical_inventory IS NOT NULL
				GROUP BY
				tosp.dealer_product_join_id
			) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
		WHERE
			tfs.is_del = 0
			AND tfs.flash_sales_id = 24
			AND tdpj.is_del = 0
			AND tdpj.is_complete = 1
			 
			 
		  	 
			 AND tdpj.dealer_product_join_id IN (  
				27508282316752
			 , 
				27841794572368
			 , 
				27508415444416
			 , 
				27508421913040
			 , 
				27508318991376
			 , 
				27508195803520
			 , 
				27508372339840
			 , 
				27841782902832
			 , 
				27508122148800
			 , 
				27264593889344
			 , 
				27508140015856
			 , 
				27508184049488
			 , 
				27508344340032
			 , 
				27841975021168
			 , 
				27508160046896
			 , 
				27841899206112
			 , 
				27508314023680
			 , 
				27508223356080
			 , 
				27508340625712
			 , 
				27508135952608
			 , 
				27841820523872
			 , 
				27841833713792
			 , 
				27841859230096
			 , 
				27841869729472
			 , 
				27841880851152
			 , 
				27841928946208
			 , 
				27841960594752
			 , 
				27841983181952
			 , 
				27842311138352
			 , 
				27842312848448
			 , 
				28109544281664
			 , 
				28109760657392
			 , 
				28109676642880
			 , 
				28109553912672
			 , 
				28109643204384
			 , 
				28109766932224
			 , 
				28109556557936
			 , 
				28109593854640
			 , 
				28109600650432
			 , 
				28109619253712
			 , 
				28109630936032
			 , 
				28109588554640
			 , 
				28109685632368
			 , 
				28110033679904
			 , 
				28109754952672
			 , 
				28109697397120
			 , 
				27508320461856
			 , 
				28110038312768
			 , 
				28109633500416
			 , 
				28109637828368
			 , 
				28110048644432
			 , 
				27508228684480
			 , 
				27508300690160
			 , 
				27508221444000
			 , 
				27508426970080
			 , 
				27508186874992
			 , 
				28109726803360
			 , 
				28109681030992
			 , 
				28109549423696
			 , 
				28616959653760
			 , 
				28616962695568
			 , 
				28616964710320
			 , 
				27508185959008
			 , 
				27508107240352
			 , 
				27508103690128
			 , 
				27572419116720
			 ) 
		GROUP BY
			tdpj.dealer_product_join_id
		ORDER BY
		     
					 FIELD ( tdpj.dealer_product_join_id,   
						27508282316752
					 , 
						27841794572368
					 , 
						27508415444416
					 , 
						27508421913040
					 , 
						27508318991376
					 , 
						27508195803520
					 , 
						27508372339840
					 , 
						27841782902832
					 , 
						27508122148800
					 , 
						27264593889344
					 , 
						27508140015856
					 , 
						27508184049488
					 , 
						27508344340032
					 , 
						27841975021168
					 , 
						27508160046896
					 , 
						27841899206112
					 , 
						27508314023680
					 , 
						27508223356080
					 , 
						27508340625712
					 , 
						27508135952608
					 , 
						27841820523872
					 , 
						27841833713792
					 , 
						27841859230096
					 , 
						27841869729472
					 , 
						27841880851152
					 , 
						27841928946208
					 , 
						27841960594752
					 , 
						27841983181952
					 , 
						27842311138352
					 , 
						27842312848448
					 , 
						28109544281664
					 , 
						28109760657392
					 , 
						28109676642880
					 , 
						28109553912672
					 , 
						28109643204384
					 , 
						28109766932224
					 , 
						28109556557936
					 , 
						28109593854640
					 , 
						28109600650432
					 , 
						28109619253712
					 , 
						28109630936032
					 , 
						28109588554640
					 , 
						28109685632368
					 , 
						28110033679904
					 , 
						28109754952672
					 , 
						28109697397120
					 , 
						27508320461856
					 , 
						28110038312768
					 , 
						28109633500416
					 , 
						28109637828368
					 , 
						28110048644432
					 , 
						27508228684480
					 , 
						27508300690160
					 , 
						27508221444000
					 , 
						27508426970080
					 , 
						27508186874992
					 , ","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","2.255","0.001","476352","66"
"2023-10-28 13:54:40","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 637643
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13107410823', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.226","0","907308","1"
"2023-10-28 22:17:24","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 388315
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18698571143', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.142","0","915842","1"
"2023-10-28 15:07:09","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 388315
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18698571143', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.087","0","908548","1"
"2023-10-29 16:27:06","SELECT tu.user_inner_id AS id,
               tu.user_phone    AS name
        FROM tenant_user_dealer_join tudj
                 LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
        WHERE (tu.user_phone = 'ZYEJ8VML8QDZ06YDJ4Q9'
            OR tudj.member_card_number = 'ZYEJ8VML8QDZ06YDJ4Q9'
            OR tu.user_nickname LIKE CONCAT('%', 'ZYEJ8VML8QDZ06YDJ4Q9', '%')
            OR tu.user_name LIKE CONCAT('%', 'ZYEJ8VML8QDZ06YDJ4Q9', '%')
            OR tu.user_union_id = 'ZYEJ8VML8QDZ06YDJ4Q9')","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.061","0","1558406","1"
"2023-10-28 21:23:27","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 535168
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13857352062', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","2.011","0","915262","1"
"2023-10-29 13:53:23","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 637726
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '15200863154', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","2.01","0","919633","1"
"2023-10-27 17:00:41","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 849248
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18072863920', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.997","0","898819","1"
"2023-10-27 13:53:44","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 129889
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13629281012', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.966","0","895619","1"
"2023-10-28 15:08:30","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 388315
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18698571143', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.935","0","908570","1"
"2023-10-27 23:30:38","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 846193
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '19113151892', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.925","0","903021","1"
"2023-10-28 16:22:21","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 414083
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13618161699', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.924","0","909989","1"
"2023-10-28 13:02:22","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 848205
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13534008667', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.916","0","906458","1"
"2023-10-27 16:13:31","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 76490
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '15751001419', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.885","0","898099","1"
"2023-10-27 23:24:26","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 846334
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13033608566', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.882","0","903007","1"
"2023-10-28 20:08:51","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 849847
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '15770652141', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.866","0","914014","1"
"2023-10-28 21:34:44","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 535168
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13857352062', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.865","0","915383","1"
"2023-10-27 21:31:37","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 637643
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13107410823', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.865","0","902172","1"
"2023-10-28 15:39:02","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 848941
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13021710991', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.852","0","909145","1"
"2023-10-29 16:26:43","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 530400
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13403634091', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.85","0","922593","1"
"2023-10-28 15:38:24","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 525786
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18866121760', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.846","0","909140","1"
"2023-10-28 15:26:10","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 388315
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18698571143', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.842","0","908941","1"
"2023-10-27 21:24:54","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 780139
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13548948902', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.841","0","902053","1"
"2023-10-28 22:16:56","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 388315
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18698571143', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.841","0","915840","1"
"2023-10-27 23:30:22","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 846923
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '19926636176', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.84","0","903020","1"
"2023-10-28 22:17:22","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 388315
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18698571143', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.84","0","915842","1"
"2023-10-29 10:12:39","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 694849
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13968195477', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.839","0","917255","1"
"2023-10-27 15:56:06","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 492726
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18930959750', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 100","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.835","0","897898","1"
"2023-10-27 21:04:14","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 354498
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '13527548181', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.5","1.83","0","901739","1"
"2023-10-27 17:17:10","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 387717
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '15655551205', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.829","0","899004","1"
"2023-10-28 15:08:02","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 388315
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '18698571143', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.822","0","908557","1"
"2023-10-27 09:22:13","SELECT
            tudj.join_id                                    AS tudjjoin_id,
            tu.user_inner_id                                AS user_inner_id,
            tu.user_avatar                                  AS tuuser_avatar,
            IFNULL( IF(LENGTH( tu.user_name )>0, tu.user_name, NULL), IF (LENGTH(tu.user_nickname)> 0, tu.user_nickname, NULL ) )         AS tuuser_name,
            tu.user_phone                                   AS tuuser_phone,
            tudj.user_status                                AS tudjuser_status,
            0                                               AS ischannel,

            tu.user_gender                                  AS tuuser_gender,
            DATE_FORMAT( tu.user_birthday, '%Y-%m-%d' )     AS tuuser_birthday,
            tu.create_date                                  AS tucreate_date,
            tust.user_source_name                           AS tustuser_source_name,

            tudj.member_card_number                         AS tudjmember_card_number,
            tudj.member_create_date                         AS tudjmember_create_date,
            tudj.member_level                               AS tudjmember_level,

            tudj.last_consumption_date                      AS tudjlast_consumption_date,
            tudj.total_cost                                 AS tudjtotal_cost,
            tudj.actually_paid                              AS tudjactually_paid,
            tudj.cost_count                                 AS tudjcost_count,
            tudj.customer_price                             AS tudjcustomer_price,
            tudj.total_refund                               AS tudjtotal_refund,
            tudj.refund_count                               AS tudjrefund_count,
            tudj.seller_create_date                         AS tudjseller_create_date,
            tea.tea_name                                    AS other1,
            tea.tea_phone                                   AS tea_phone,
            ts.store_name                                   AS tudjstore_id,

            tudj.store_id                                   AS store_id,
            tust.user_source_id                             AS user_source_id,
            ts.dealer_id                                    AS dealer_id,
            tudj.assistant_id                               AS assistant_id,
            tudj.last_access_time                           AS last_access_time,

            tudj.seller_level AS tudjseller_level,
            IF ( tudj.belong_seller = - 1, NULL, tudj.belong_seller ) AS tudjbelong_seller,
            (SELECT member_level_name FROM tenant_member_card_option WHERE member_level = tudj.member_level) AS memberLevelName
        FROM
            tenant_user_dealer_join tudj
            LEFT JOIN tenant_user tu ON tu.user_inner_id = tudj.user_id
            LEFT JOIN tenant_store ts ON tudj.store_id = ts.store_inner_id
            LEFT JOIN tenant_user_source_type tust ON tu.user_source_id = tust.user_source_id
            AND tust.is_del = 0
            LEFT JOIN tenant_employee_account tea ON tudj.assistant_id = tea.tea_id
            LEFT JOIN ( SELECT tust.user_inner_id, tust.user_store_track_mode FROM tenant_user_store_track tust GROUP BY tust.user_inner_id ) tusts ON tu.user_inner_id = tusts.user_inner_id
         WHERE tudj.join_id <= 637772
            AND tu.is_del = 0
            
            
                

                        AND tu.user_phone LIKE CONCAT( '%', '17812580141', '%' ) 
        GROUP BY
            tudj.join_id
        ORDER BY
            tudj.join_id DESC
        LIMIT 10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.803","0","891478","1"
"2023-10-27 10:10:23","SELECT
			tdpj.dealer_product_join_id,
			tdpj.dealer_product_join_outer_id,
			tdpj.dealer_product_name,
			tdpj.main_cover,
			IFNULL( topd.count, 0 ) AS count,
			IFNULL( stock.physical_inventory, 0 ) AS stock
		FROM
			tenant_flash_sales tfs
			LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tfs.marketing_activity_id = tpmaj.marketing_activity_id
			LEFT JOIN tenant_dealer_product_join tdpj ON tpmaj.dealer_product_join_id = tdpj.dealer_product_join_id
			LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj.dealer_product_join_id = tpoo.dealer_product_join_id
			LEFT JOIN (
				SELECT
					topd.dealer_product_join_id,
					COUNT( topd.dealer_product_join_id ) AS count
				FROM
					tenant_order tor
					LEFT JOIN tenant_order_product_detail topd ON tor.order_inner_id = topd.order_id
					AND topd.is_del = 0
				WHERE
					tor.is_del = 0
					AND tor.order_status != 6
				GROUP BY
					topd.dealer_product_join_id
			) topd ON tpmaj.dealer_product_join_id = topd.dealer_product_join_id
		LEFT JOIN (
				SELECT
					tdpj.dealer_product_join_id,
					SUM( ts.physical_inventory ) AS physical_inventory
				FROM
					tenant_dealer_product_join tdpj
					LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
						AND tosp.is_del = 0
					LEFT JOIN tenant_stock ts ON tosp.single_product_id = ts.single_product_id
				WHERE
					tdpj.is_del = 0
					 AND tdpj.dealer_product_join_id IN (  
						27841794572368
					 , 
						27508415444416
					 , 
						27508421913040
					 , 
						27508318991376
					 , 
						27508195803520
					 , 
						27508372339840
					 , 
						27841782902832
					 , 
						27508122148800
					 , 
						27264593889344
					 , 
						27508140015856
					 , 
						27508184049488
					 , 
						27508344340032
					 , 
						27841975021168
					 , 
						27508160046896
					 , 
						27841899206112
					 , 
						27508314023680
					 , 
						27508223356080
					 , 
						27508340625712
					 , 
						27508135952608
					 , 
						27841820523872
					 , 
						27841833713792
					 , 
						27841859230096
					 , 
						27841869729472
					 , 
						27841880851152
					 , 
						27841928946208
					 , 
						27841960594752
					 , 
						27841983181952
					 , 
						27842311138352
					 , 
						27842312848448
					 , 
						28109544281664
					 , 
						28109760657392
					 , 
						28109676642880
					 , 
						28109553912672
					 , 
						28109643204384
					 , 
						28109766932224
					 , 
						28109556557936
					 , 
						28109593854640
					 , 
						28109600650432
					 , 
						28109619253712
					 , 
						28109630936032
					 , 
						28109588554640
					 , 
						28109685632368
					 , 
						28110033679904
					 , 
						28109754952672
					 , 
						28110038312768
					 , 
						28109633500416
					 , 
						28109637828368
					 , 
						28110048644432
					 , 
						28109726803360
					 , 
						28109697397120
					 , 
						28109681030992
					 , 
						28109549423696
					 , 
						28616959653760
					 , 
						28616962695568
					 , 
						28616964710320
					 , 
						27508185959008
					 , 
						27508107240352
					 , 
						27508103690128
					 ) 
					AND	(
							(
								tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
									tss.warehouse_id
									FROM
									tenant_store ts
									LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
									LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
									ts.is_del = 0
									AND tsc.is_del = 0
									AND tss.is_del = 0
									 
											AND ts.store_inner_id = -1
										 
									AND tsc.store_channel_type = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND tdpj.has_express_delivery = 1
								AND ts.warehouse_id IN (
									SELECT
										tss.warehouse_id
									FROM
										tenant_store ts
										LEFT JOIN tenant_store_channel tsc ON ts.store_inner_id = tsc.store_id
										LEFT JOIN tenant_stock_share tss ON tsc.store_channel_id = tss.store_channel_id
									WHERE
										ts.is_del = 0
										AND tsc.is_del = 0
										AND tss.is_del = 0
										 
												AND ts.store_inner_id = -1
											 
										AND tsc.store_channel_type = 0
									UNION
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						OR (
								tdpj.has_pick_up = 1
								AND ts.warehouse_id IN (
									SELECT
										tspusj.shipper_id AS warehouse_id
									FROM
										tenant_self_pick_up_site tspus
										LEFT JOIN tenant_self_pick_up_site_join tspusj ON tspus.self_pick_up_site_id = tspusj.self_pick_up_site_id
									WHERE
										tspus.is_del = 0
										AND tspus.pick_up_status = 1
										AND tspusj.is_del = 0
								)
							)
						)
				AND ts.physical_inventory IS NOT NULL
				GROUP BY
				tosp.dealer_product_join_id
			) stock ON tpmaj.dealer_product_join_id = stock.dealer_product_join_id
		WHERE
			tfs.is_del = 0
			AND tfs.flash_sales_id = 24
			AND tdpj.is_del = 0
			AND tdpj.is_complete = 1
			 
			 
		  	 
			 AND tdpj.dealer_product_join_id IN (  
				27841794572368
			 , 
				27508415444416
			 , 
				27508421913040
			 , 
				27508318991376
			 , 
				27508195803520
			 , 
				27508372339840
			 , 
				27841782902832
			 , 
				27508122148800
			 , 
				27264593889344
			 , 
				27508140015856
			 , 
				27508184049488
			 , 
				27508344340032
			 , 
				27841975021168
			 , 
				27508160046896
			 , 
				27841899206112
			 , 
				27508314023680
			 , 
				27508223356080
			 , 
				27508340625712
			 , 
				27508135952608
			 , 
				27841820523872
			 , 
				27841833713792
			 , 
				27841859230096
			 , 
				27841869729472
			 , 
				27841880851152
			 , 
				27841928946208
			 , 
				27841960594752
			 , 
				27841983181952
			 , 
				27842311138352
			 , 
				27842312848448
			 , 
				28109544281664
			 , 
				28109760657392
			 , 
				28109676642880
			 , 
				28109553912672
			 , 
				28109643204384
			 , 
				28109766932224
			 , 
				28109556557936
			 , 
				28109593854640
			 , 
				28109600650432
			 , 
				28109619253712
			 , 
				28109630936032
			 , 
				28109588554640
			 , 
				28109685632368
			 , 
				28110033679904
			 , 
				28109754952672
			 , 
				28110038312768
			 , 
				28109633500416
			 , 
				28109637828368
			 , 
				28110048644432
			 , 
				28109726803360
			 , 
				28109697397120
			 , 
				28109681030992
			 , 
				28109549423696
			 , 
				28616959653760
			 , 
				28616962695568
			 , 
				28616964710320
			 , 
				27508185959008
			 , 
				27508107240352
			 , 
				27508103690128
			 ) 
		GROUP BY
			tdpj.dealer_product_join_id
		ORDER BY
		     
					 FIELD ( tdpj.dealer_product_join_id,   
						27841794572368
					 , 
						27508415444416
					 , 
						27508421913040
					 , 
						27508318991376
					 , 
						27508195803520
					 , 
						27508372339840
					 , 
						27841782902832
					 , 
						27508122148800
					 , 
						27264593889344
					 , 
						27508140015856
					 , 
						27508184049488
					 , 
						27508344340032
					 , 
						27841975021168
					 , 
						27508160046896
					 , 
						27841899206112
					 , 
						27508314023680
					 , 
						27508223356080
					 , 
						27508340625712
					 , 
						27508135952608
					 , 
						27841820523872
					 , 
						27841833713792
					 , 
						27841859230096
					 , 
						27841869729472
					 , 
						27841880851152
					 , 
						27841928946208
					 , 
						27841960594752
					 , 
						27841983181952
					 , 
						27842311138352
					 , 
						27842312848448
					 , 
						28109544281664
					 , 
						28109760657392
					 , 
						28109676642880
					 , 
						28109553912672
					 , 
						28109643204384
					 , 
						28109766932224
					 , 
						28109556557936
					 , 
						28109593854640
					 , 
						28109600650432
					 , 
						28109619253712
					 , 
						28109630936032
					 , 
						28109588554640
					 , 
						28109685632368
					 , 
						28110033679904
					 , 
						28109754952672
					 , 
						28110038312768
					 , 
						28109633500416
					 , 
						28109637828368
					 , 
						28110048644432
					 , 
						28109726803360
					 , 
						28109697397120
					 , 
						28109681030992
					 , 
						28109549423696
					 , 
						28616959653760
					 , 
						28616962695568
					 , 
						28616964710320
					 , 
						27508185959008
					 , 
						27508107240352
					 , 
						27508103690128
					 )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.784","0","418763","58"
"2023-10-28 14:11:01","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.665","0","645752","7"
"2023-10-29 19:26:50","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.612","0","653276","8"
"2023-10-29 19:21:47","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.565","0","653269","8"
"2023-10-27 08:03:35","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 37
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.529","0","222873","188"
"2023-10-29 14:04:28","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.483","0","648617","7"
"2023-10-27 11:19:05","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.478","0","640466","7"
"2023-10-29 14:41:23","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.46","0","472386","10"
"2023-10-28 15:00:57","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.423","0","645807","7"
"2023-10-27 08:03:54","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 37
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.393","0","222873","188"
"2023-10-29 16:23:01","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.38","0","651582","8"
"2023-10-29 14:42:18","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.377","0","650161","8"
"2023-10-27 08:03:55","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 37
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.353","0","222873","188"
"2023-10-29 17:59:16","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCD76EO1LQE0YVJQY0WJNM'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.337","0","237986","1"
"2023-10-29 15:34:48","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.332","0","237078","84"
"2023-10-29 15:02:46","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.317","0","650178","8"
"2023-10-29 14:38:13","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.314","0","650155","8"
"2023-10-28 14:27:31","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.312","0","645784","7"
"2023-10-29 14:03:04","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.304","0","648615","7"
"2023-10-29 14:38:59","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.298","0","650157","8"
"2023-10-28 20:01:09","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC27JY54VZME2NV83GMNP1'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.28","0","232204","1"
"2023-10-29 17:59:31","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 64
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.275","0","240576","188"
"2023-10-29 20:36:20","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.271","0","653683","8"
"2023-10-28 14:12:11","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.268","0","645775","7"
"2023-10-29 22:01:26","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 6
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.262","0","242586","188"
"2023-10-29 15:44:48","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.261","0","650895","8"
"2023-10-29 14:23:28","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.261","0","472126","1"
"2023-10-29 14:37:08","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.255","0","650150","7"
"2023-10-29 19:27:30","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.252","0","653277","8"
"2023-10-27 11:26:47","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.25","0","640472","7"
"2023-10-28 13:55:41","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 14
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.25","0","231628","188"
"2023-10-28 21:24:44","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDCE1NYGK6QGVP5Q57O02XL'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.242","0","232936","1"
"2023-10-29 14:38:00","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.241","0","650155","8"
"2023-10-27 14:07:25","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 28281510817456
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
                AND (
                    tp.product_name LIKE CONCAT( '%', '3EA332591', '%' )
                    OR
                    tdpj.dealer_product_name LIKE CONCAT( '%', '3EA332591', '%' )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.241","0.001","1502379","1"
"2023-10-29 14:10:45","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCV65GPEOZ04NP482KJW1N'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.239","0","235794","1"
"2023-10-29 16:23:50","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.235","0","651585","8"
"2023-10-28 14:57:59","SELECT
        t2.tea_id AS createUser,
        t2.tea_name AS teaName
        FROM
        tenant_warehouse_receipt t1
        LEFT JOIN tenant_employee_account t2 ON t1.create_user = t2.tea_id
         WHERE t1.is_del = 0
            
                    AND t1.send_warehouse_id = -1 
        GROUP BY
        t1.create_user","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.229","0","645804","7"
"2023-10-28 20:35:42","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC7W6RXGJZ97DPP83LP41O'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.226","0","232544","1"
"2023-10-29 15:34:49","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 52
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.22","0","239186","188"
"2023-10-29 15:34:00","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 86
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.215","0","239184","188"
"2023-10-28 17:19:17","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDC91XWO03ZXNXKQDM2PJEK'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.204","0","230789","1"
"2023-10-29 18:00:27","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCE05Y73L8451LGQX49O2W'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.203","0","238011","1"
"2023-10-29 15:58:32","SELECT
            tmc.marketing_coupon_id,
            tmc.marketing_coupon_name ,
            tmc.marketing_coupon_status ,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber
        FROM
            tenant_marketing_coupon tmc
                LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                  AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmc.is_del = 0","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.198","0","236983","24"
"2023-10-27 13:06:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 120
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.195","0","223487","188"
"2023-10-29 15:34:43","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 245
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.194","0.001","239186","188"
"2023-10-29 15:34:48","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 52
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.192","0","239186","188"
"2023-10-29 15:34:48","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.186","0","239186","188"
"2023-10-29 13:53:46","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 13
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.185","0.001","238232","188"
"2023-10-29 15:23:47","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDCXD6VE7M8VNL3JQOPN5K0'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.179","0","236486","1"
"2023-10-28 21:26:56","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCXD6VE7M8VV5198OPN5K0'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.175","0","232969","1"
"2023-10-29 15:36:03","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDC35RJ1M9QRKEXK8EY7WVX'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.172","0","236640","1"
"2023-10-29 19:25:05","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 186
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.172","0","241421","188"
"2023-10-28 15:02:00","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.171","0","459462","10"
"2023-10-27 14:06:53","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 28281510817456
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
                AND (
                    tp.product_name LIKE CONCAT( '%', '3EA332591', '%' )
                    OR
                    tdpj.dealer_product_name LIKE CONCAT( '%', '3EA332591', '%' )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.168","0.001","1502379","1"
"2023-10-29 15:34:43","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.166","0","239186","188"
"2023-10-28 15:01:59","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.164","0","459500","1"
"2023-10-29 13:54:01","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 11
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.161","0","238232","188"
"2023-10-28 21:40:18","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 87
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.159","0","235713","188"
"2023-10-27 19:06:01","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 205
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.157","0","228300","188"
"2023-10-29 16:45:56","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDC35RJ1M9QRG0NZEY7WVXN'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.156","0","237263","1"
"2023-10-28 16:34:08","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC2GL0KP3Z2WWXW8M4XVYD'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.156","0","230362","1"
"2023-10-29 23:03:38","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 143
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.156","0","242748","188"
"2023-10-29 15:34:49","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 245
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.154","0","239186","188"
"2023-10-29 15:58:32","SELECT
            tmc.marketing_coupon_id,
            tmc.marketing_coupon_name ,
            tmc.marketing_coupon_status ,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber
        FROM
            tenant_marketing_coupon tmc
                LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                  AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmc.is_del = 0
             AND tmc.marketing_coupon_id IN (  
                78
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.152","0","236936","1"
"2023-10-28 16:07:09","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 27036027416192
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
            
                AND (
                    tp.third_code IN(
                    
                        '3EA780211'
                    
                    )
                    OR
                    tdpj.dealer_product_code IN(
                    
                        '3EA780211'
                    
                    )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.152","0.001","1453456","1"
"2023-10-29 15:34:42","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 52
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.15","0","239186","188"
"2023-10-29 16:07:30","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC2GL0KP3Z2JP22ZM4XVYD'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.149","0","236903","1"
"2023-10-28 16:07:00","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 27036027416192
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
            
                AND (
                    tp.third_code IN(
                    
                        '3EA780211'
                    
                    )
                    OR
                    tdpj.dealer_product_code IN(
                    
                        '3EA780211'
                    
                    )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.148","0.001","1453456","1"
"2023-10-29 15:52:46","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 120
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.145","0.001","239351","188"
"2023-10-28 19:25:09","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC91XWO03ZX17LXZDM2PJE'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.141","0","231966","1"
"2023-10-29 17:59:25","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                172
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.137","0","238468","84"
"2023-10-28 00:59:58","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 211
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.137","0","229687","188"
"2023-10-29 14:25:54","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 22
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.136","0","238486","188"
"2023-10-28 12:55:29","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCEPL7425ZPP104Z60O1X3'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.134","0","228588","1"
"2023-10-27 12:06:21","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.133","0","223470","188"
"2023-10-29 15:35:37","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.133","0","239230","188"
"2023-10-29 22:07:54","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 202
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.13","0","242620","188"
"2023-10-28 16:07:53","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 27036027416192
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
            
                AND (
                    tp.third_code IN(
                    
                        '3EA780211'
                    
                    )
                    OR
                    tdpj.dealer_product_code IN(
                    
                        '3EA780211'
                    
                    )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.129","0.001","1453456","1"
"2023-10-29 21:47:26","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC3XRJEGW8NRP99Q910K5V'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.128","0","239922","1"
"2023-10-28 16:29:03","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 28281509514224
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
                AND (
                    tp.product_name LIKE CONCAT( '%', '3EA332501', '%' )
                    OR
                    tdpj.dealer_product_name LIKE CONCAT( '%', '3EA332501', '%' )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.121","0.001","1501188","1"
"2023-10-29 15:58:32","SELECT
            tmc.marketing_coupon_id,
            tmc.marketing_coupon_name ,
            tmc.marketing_coupon_status ,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber
        FROM
            tenant_marketing_coupon tmc
                LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                  AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmc.is_del = 0","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.121","0","236983","24"
"2023-10-29 15:58:32","SELECT
            tmc.marketing_coupon_id,
            tmc.marketing_coupon_name ,
            tmc.marketing_coupon_status ,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber
        FROM
            tenant_marketing_coupon tmc
                LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                  AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmc.is_del = 0","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.121","0","236983","24"
"2023-10-29 15:07:22","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 11
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.119","0","238906","188"
"2023-10-29 13:34:06","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 125
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.118","0","238051","188"
"2023-10-29 15:35:38","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 245
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.117","0","239230","188"
"2023-10-28 21:03:49","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.117","0","235369","188"
"2023-10-29 10:00:53","SELECT marketing_coupon_name AS couponName, marketing_coupon_type AS couponType, COUNT(1) AS sendNum
        FROM tenant_user_coupon
        WHERE relation_server_id = 7392915687356672
          AND is_del = 0
        GROUP BY marketing_coupon_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.113","0","234200","0"
"2023-10-29 16:11:36","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.113","0","474218","10"
"2023-10-29 20:55:59","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.112","0","479594","20"
"2023-10-27 16:58:32","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                157
             , 
                137
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.111","0","225138","84"
"2023-10-29 17:34:21","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC91XWO03ZXOKPYZDM2PJE'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.107","0","237753","1"
"2023-10-29 10:01:35","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.105","0","236790","188"
"2023-10-28 21:19:57","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.105","0","235478","188"
"2023-10-29 09:06:05","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 22
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.102","0","236702","188"
"2023-10-29 17:59:29","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 64
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.101","0","240576","188"
"2023-10-29 16:11:35","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.099","0","474256","1"
"2023-10-29 15:48:03","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC0JR1OLVZKNMGPZ4K6M9W'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.097","0","236724","1"
"2023-10-29 19:58:54","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 200
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.095","0","241626","188"
"2023-10-27 11:44:55","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 26
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.095","0","223459","188"
"2023-10-29 17:47:49","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDCGE07ORVZ111O7ZXD943K'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.093","0","237894","1"
"2023-10-29 13:10:43","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDC35RJ1M9QRV3P3ZEY7WVX'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.092","0","235386","1"
"2023-10-27 18:44:39","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 6
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.092","0","228169","188"
"2023-10-27 12:52:12","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.092","0","223484","188"
"2023-10-29 22:20:28","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 120
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.09","0","242647","188"
"2023-10-28 16:28:54","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 28281509514224
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
                AND (
                    tp.product_name LIKE CONCAT( '%', '3EA332501', '%' )
                    OR
                    tdpj.dealer_product_name LIKE CONCAT( '%', '3EA332501', '%' )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.089","0.001","1501188","1"
"2023-10-28 12:28:22","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 27190865124672
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
                AND (
                    tp.product_name LIKE CONCAT( '%', '3EA493171', '%' )
                    OR
                    tdpj.dealer_product_name LIKE CONCAT( '%', '3EA493171', '%' )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.089","0.001","1461506","1"
"2023-10-29 18:47:51","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 13
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.088","0","241087","188"
"2023-10-28 11:18:42","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 245
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.088","0","230550","188"
"2023-10-29 20:45:53","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                172
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.088","0","240019","84"
"2023-10-27 11:37:49","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 63
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.085","0","222951","188"
"2023-10-29 13:30:44","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.085","0","235939","84"
"2023-10-27 11:17:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.079","0","222935","188"
"2023-10-28 22:21:33","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.079","0","233958","84"
"2023-10-28 20:01:09","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDCW65KXJO8J013QN3RGV4L'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.077","0","232204","1"
"2023-10-29 13:53:23","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 165
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.076","0","238231","188"
"2023-10-27 13:05:03","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.076","0","223487","188"
"2023-10-29 13:10:43","SELECT marketing_coupon_name AS couponName, marketing_coupon_type AS couponType, COUNT(1) AS sendNum
        FROM tenant_user_coupon
        WHERE relation_server_id = 7422741882193664
          AND is_del = 0
        GROUP BY marketing_coupon_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.075","0","235386","0"
"2023-10-29 20:00:25","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDCGE07ORVZ11LP2ZXD943K'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.074","0","239092","1"
"2023-10-29 16:45:56","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCV65GPEOZ04ORN82KJW1N'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.074","0","237263","1"
"2023-10-29 22:00:27","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                123
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.072","0","240478","84"
"2023-10-29 14:41:49","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 155
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.072","0","238620","188"
"2023-10-29 16:47:40","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 155
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.072","0","239855","188"
"2023-10-29 14:55:59","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.072","0","472754","1"
"2023-10-29 15:58:31","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.072","0","237281","84"
"2023-10-28 12:55:29","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC56ED1RGZ75W1580OYLJ3'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.07","0","228588","1"
"2023-10-28 12:28:57","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 27190865124672
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
                AND (
                    tp.product_name LIKE CONCAT( '%', '3EA493171', '%' )
                    OR
                    tdpj.dealer_product_name LIKE CONCAT( '%', '3EA493171', '%' )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.07","0.001","1461506","1"
"2023-10-27 21:23:47","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.069","0","229165","188"
"2023-10-28 21:59:08","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                180
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.067","0","233761","84"
"2023-10-27 12:15:36","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 127
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.066","0.001","223474","188"
"2023-10-29 16:12:16","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 17
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.066","0","239537","188"
"2023-10-29 22:25:24","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 170
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.066","0","242668","188"
"2023-10-29 15:34:42","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 33
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.065","0","239186","188"
"2023-10-29 16:07:18","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.065","0","237385","84"
"2023-10-27 14:42:21","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 20
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.065","0","226334","188"
"2023-10-29 08:34:13","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.065","0","236689","188"
"2023-10-29 18:47:51","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 13
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.065","0","241087","188"
"2023-10-28 23:23:18","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                160
             , 
                157
             , 
                128
             , 
                179
             , 
                180
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.065","0","234106","84"
"2023-10-28 19:58:20","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 197
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.065","0","234743","188"
"2023-10-29 14:56:00","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.064","0","472716","10"
"2023-10-29 17:15:11","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 129
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.063","0","240209","188"
"2023-10-29 19:25:05","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC91XWO03ZXD2OR8DM2PJE'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.063","0","238831","1"
"2023-10-29 15:37:44","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.062","0","473652","1"
"2023-10-27 13:23:17","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.062","0","223976","188"
"2023-10-29 14:14:12","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.062","0","471956","1"
"2023-10-29 15:36:03","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 143
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.062","0","239230","188"
"2023-10-28 14:59:11","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.062","0","459380","10"
"2023-10-27 21:43:07","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCW9L471PZ59LW18K3V6DM'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.06","0","226674","1"
"2023-10-29 16:47:36","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 37
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.06","0.001","239855","188"
"2023-10-28 16:07:19","SELECT
            GROUP_CONCAT( DISTINCT tp.product_inner_id)                                                     AS productInnerId,
            GROUP_CONCAT( DISTINCT tp.product_outer_id)                                                     AS productOutId,
            tdpj.dealer_product_code                                                                        AS thirdCode,
            GROUP_CONCAT( DISTINCT tb.brand_name)                                                           AS brandName,
            GROUP_CONCAT( DISTINCT vbcp.leafname)                                                           AS leafName,
            GROUP_CONCAT( DISTINCT vbcp.combname)                                                           AS backCateName,
            tdpj.dealer_product_join_id                                                                     AS dealerProductId,
            tdpj.dealer_product_join_outer_id                                                               AS dealerProductOutId,
            tdpj.dealer_product_name                                                                        AS dealerProductName,
            tdpj.main_cover                                                                                 AS mainCover,
            tdpj.selling_point                                                                              AS sellingPoint,
            MIN( tosp.retail_price )                                                                        AS minPrice,
            MAX( tosp.retail_price )                                                                        AS maxPrice,
            IFNULL( tdpj.min_price, 0 )                                                                     AS retailPrice,
            IFNULL( tdpj.min_del_price, 0 )                                                                 AS delPrice,
            IFNULL( ( CASE 0
            WHEN 0 THEN SUM(ts.physical_inventory)
            WHEN 1 THEN SUM(ts.physical_inventory)
            WHEN 2 THEN vsps2.physical_inventory
            ELSE 0
            END ), 0 ) AS stockNum,
            IFNULL( tspsv.store_product_sales_volume, 0 )                                                   AS sellCount,
            tdpj.create_date                                                                                AS createDate,
            tfc.frontCateNameList                                                                           AS frontCateNameList,
            tfc.frontCateOutIdList                                                                          AS frontCateOutIdList,
            tdpj.dealer_product_join_type                                                                   AS dealerProductJoinType,
            tdpj.has_express_delivery                                                                       AS hasExpressDelivery,
            tdpj.has_in_city_delivery                                                                       AS hasInCityDelivery,
            tdpj.has_pick_up                                                                                AS hasPickUp,
            tdpj.fare_template                                                                              AS freightTemplateId,
            tdpj.sale_limit                                                                                 AS saleLimit,
            tdpj.member_limit                                                                               AS memberLimit,
            tdpj.member_limit_level                                                                         AS memberLimitLevel,
            tdpj.sale_limit_type                                                                            AS saleLimitType,
            tdpj.is_user_limit                                                                              AS isUserLimit,
            tdpj.on_discount                                                                                AS hasDiscount
        FROM
            tenant_dealer_product_join tdpj
            LEFT JOIN tenant_onlinestore_single_product tosp ON tdpj.dealer_product_join_id = tosp.dealer_product_join_id
                AND tosp.is_del = 0
            LEFT JOIN tenant_single_product tsp ON tosp.single_product_id = tsp.single_product_inner_id
                AND tsp.is_enable = 1
                AND tsp.is_del = 0
            LEFT JOIN tenant_product tp ON tp.product_inner_id = tosp.product_id
            LEFT JOIN tenant_brand tb ON tp.brand_id = tb.brand_inner_id
            LEFT JOIN v_back_cate_path vbcp ON tp.back_cate_id = vbcp.leafcateid
        -- 商品库存
            LEFT JOIN tenant_stock ts ON ts.product_id = tosp.product_id
                AND ts.single_product_id = tosp.single_product_id
            LEFT JOIN tenant_warehouse tw ON tw.warehouse_inner_id = ts.warehouse_id
                AND tw.dealer_id = 1
            -- 商品销量
            LEFT JOIN (
                SELECT
                    tspsv.store_product_id,
                    SUM( tspsv.store_product_sales_volume ) AS store_product_sales_volume
                FROM
                    tenant_store_product_sales_volume tspsv
                WHERE
                    tspsv.is_del = 0
                    AND tspsv.dealer_inner_id = 1
                GROUP BY
                    tspsv.store_product_id
            ) tspsv ON tspsv.store_product_id = tdpj.dealer_product_join_id
            -- 商品分类
            LEFT JOIN (
                SELECT
                    tpfcj.dealer_product_join_id,
                    GROUP_CONCAT( DISTINCT tfc.cate_name ORDER BY tfc.cate_inner_id ) AS frontCateNameList,
                    GROUP_CONCAT( DISTINCT tfc.cate_outer_id ORDER BY tfc.cate_inner_id ) AS frontCateOutIdList
                FROM
                    tenant_product_front_cate_join tpfcj
                LEFT JOIN tenant_frontend_category tfc ON tfc.cate_inner_id = tpfcj.frond_cate_id
                    GROUP BY tpfcj.dealer_product_join_id
            ) tfc ON tfc.dealer_product_join_id = tdpj.dealer_product_join_id
            -- 商品共享库存
            LEFT JOIN (
                SELECT
                    dealer_product_join_id,
                    SUM( physical_inventory ) AS physical_inventory
                FROM
                    v_single_product_stock
                WHERE
                    store_channel_type = 0
                    AND store_inner_id = null
                    AND ( warehouse_is_express = 1 OR warehouse_is_pick_up = 1 OR warehouse_is_city_delivery = 1 )
                GROUP BY
                    dealer_product_join_id
            ) vsps2 ON tdpj.dealer_product_join_id = vsps2.dealer_product_join_id
         WHERE tdpj.is_del = 0
            AND tp.is_del = 0
            AND tdpj.dealer_id = 1
            AND tdpj.dealer_product_join_id <= 27036027416192
            
                AND tdpj.dealer_product_join_type = 0
            
            
                AND tdpj.is_complete = '1'
            
            
            
                AND (
                    tp.third_code IN(
                    
                        '3EA780211'
                    
                    )
                    OR
                    tdpj.dealer_product_code IN(
                    
                        '3EA780211'
                    
                    )
                ) 
        GROUP BY
        tdpj.dealer_product_join_id
             
        ORDER BY
        tdpj.dealer_product_join_id DESC
        LIMIT 20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.06","0.001","1453456","1"
"2023-10-27 21:27:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 65
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.059","0","229193","188"
"2023-10-29 16:12:58","SELECT marketing_coupon_name AS couponName, marketing_coupon_type AS couponType, COUNT(1) AS sendNum
        FROM tenant_user_coupon
        WHERE relation_server_id = 7423137630646528
          AND is_del = 0
        GROUP BY marketing_coupon_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.059","0","236948","0"
"2023-10-29 16:07:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 82
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.058","0","239493","188"
"2023-10-27 15:11:45","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 78
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.058","0","226611","188"
"2023-10-27 13:06:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 41
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.057","0","223487","188"
"2023-10-29 14:14:13","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.057","0","471918","10"
"2023-10-29 16:07:49","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 82
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.057","0","239493","188"
"2023-10-27 19:43:22","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                157
             , 
                137
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.056","0","226510","84"
"2023-10-29 19:59:08","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.056","0","239519","84"
"2023-10-29 19:59:08","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 200
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.056","0","241627","188"
"2023-10-28 16:33:11","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 52
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.056","0","232951","188"
"2023-10-29 17:59:26","SELECT
            tmc.marketing_coupon_id,
            tmc.marketing_coupon_name ,
            tmc.marketing_coupon_status ,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber
        FROM
            tenant_marketing_coupon tmc
                LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                  AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmc.is_del = 0","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.055","0","238170","24"
"2023-10-29 10:18:41","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.055","0.001","236839","188"
"2023-10-27 20:17:17","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 54
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.055","0","228839","188"
"2023-10-29 15:23:23","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 33
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.055","0","239076","188"
"2023-10-29 12:00:52","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.055","0","237639","188"
"2023-10-29 10:00:32","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.055","0","234682","84"
"2023-10-29 14:41:22","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.054","0","472424","1"
"2023-10-27 14:22:46","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 31
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.054","0","226121","188"
"2023-10-29 16:07:30","SELECT marketing_coupon_name AS couponName, marketing_coupon_type AS couponType, COUNT(1) AS sendNum
        FROM tenant_user_coupon
        WHERE relation_server_id = 7421229651783680
          AND is_del = 0
        GROUP BY marketing_coupon_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.054","0","236903","0"
"2023-10-28 21:19:12","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 89
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.053","0","235476","188"
"2023-10-29 20:00:25","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 51
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.052","0","241682","188"
"2023-10-29 20:55:58","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.052","0","479622","1"
"2023-10-29 21:01:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.052","0","242254","188"
"2023-10-29 22:01:26","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 101
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.051","0","242586","188"
"2023-10-28 19:33:45","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 114
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.051","0","234595","188"
"2023-10-29 16:07:18","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 188
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.05","0","239493","188"
"2023-10-29 15:39:01","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.049","0","239236","188"
"2023-10-29 16:07:49","SELECT
            tmc.marketing_coupon_id,
            tmc.marketing_coupon_name ,
            tmc.marketing_coupon_status ,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber
        FROM
            tenant_marketing_coupon tmc
                LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                  AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmc.is_del = 0","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.048","0","237087","24"
"2023-10-27 12:04:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.048","0","223470","188"
"2023-10-29 16:32:21","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 17
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.048","0","239711","188"
"2023-10-29 22:00:27","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.048","0","240478","84"
"2023-10-29 20:45:00","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.048","0","239964","84"
"2023-10-29 20:55:12","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.048","0","479620","1"
"2023-10-27 17:16:01","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.046","0","449962","1"
"2023-10-29 10:00:33","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.046","0","236790","188"
"2023-10-28 16:11:35","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 166
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.046","0","232772","188"
"2023-10-27 15:37:22","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 185
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.046","0","226823","188"
"2023-10-29 15:58:31","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.045","0","237281","84"
"2023-10-29 10:02:38","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.045","0","234682","84"
"2023-10-29 15:34:00","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 217
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.045","0","239184","188"
"2023-10-29 21:30:26","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 49
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.045","0","242468","188"
"2023-10-29 10:00:33","SELECT marketing_coupon_name AS couponName, marketing_coupon_type AS couponType, COUNT(1) AS sendNum
        FROM tenant_user_coupon
        WHERE relation_server_id = 7415876235630080
          AND is_del = 0
        GROUP BY marketing_coupon_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.045","0","234200","0"
"2023-10-29 20:55:36","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
                AND tmc.marketing_coupon_name LIKE concat('%','7.8','%')
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.044","0","479488","1"
"2023-10-29 20:55:27","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
                AND tmc.marketing_coupon_name LIKE concat('%','7.8','%')
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.044","0","479486","2"
"2023-10-29 20:55:26","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
                AND tmc.marketing_coupon_name LIKE concat('%','7.8','%')
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.043","0","479488","1"
"2023-10-29 15:37:45","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.043","0","473614","10"
"2023-10-29 21:30:26","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCNWLV420Z63V3NZEXKG53'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.043","0","239878","1"
"2023-10-27 11:08:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 80
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.043","0","222928","188"
"2023-10-28 20:01:09","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC91XWO03ZXOG5PZDM2PJE'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.042","0","232204","1"
"2023-10-29 20:55:37","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
                AND tmc.marketing_coupon_name LIKE concat('%','7.8','%')
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.042","0","479486","2"
"2023-10-29 17:59:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 37
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.042","0","240576","188"
"2023-10-27 17:16:10","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
                AND tmc.marketing_coupon_name LIKE concat('%','7.8','%')
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.041","0","449828","2"
"2023-10-29 20:50:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 55
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.04","0.001","242174","188"
"2023-10-29 17:44:30","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC91XWO03ZXG90P8DM2PJE'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.039","0","237846","1"
"2023-10-29 16:12:16","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 17
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.039","0.001","239537","188"
"2023-10-29 20:55:13","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,20","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.039","0","479592","20"
"2023-10-29 10:10:17","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.038","0","236808","188"
"2023-10-27 19:06:01","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 39
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.038","0","228300","188"
"2023-10-29 16:20:18","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 186
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.038","0","239638","188"
"2023-10-29 20:00:24","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.037","0","239574","84"
"2023-10-27 17:16:02","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.037","0","449924","10"
"2023-10-29 19:59:52","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 51
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.037","0","241628","188"
"2023-10-27 11:08:30","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                157
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.037","0","220820","84"
"2023-10-28 12:42:07","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                157
             , 
                137
             , 
                160
             , 
                123
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.037","0","228984","84"
"2023-10-29 18:05:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 7
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.036","0","240641","188"
"2023-10-29 09:06:06","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.036","0","234594","84"
"2023-10-29 15:34:09","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 217
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.036","0","239185","188"
"2023-10-27 15:38:34","SELECT
            tmc.marketing_coupon_id,
            tmc.marketing_coupon_name ,
            tmc.marketing_coupon_status ,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber
        FROM
            tenant_marketing_coupon tmc
                LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                  AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmc.is_del = 0
             AND tmc.marketing_coupon_id IN (  
                78
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.035","0","224370","1"
"2023-10-29 19:25:05","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 215
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.035","0","241421","188"
"2023-10-29 10:02:38","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 195
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.035","0","236790","188"
"2023-10-28 22:01:08","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 197
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.034","0","235903","188"
"2023-10-28 14:55:05","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.034","0","459354","10"
"2023-10-29 15:36:03","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 245
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.034","0.001","239230","188"
"2023-10-29 16:47:41","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 155
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.033","0.001","239855","188"
"2023-10-29 20:50:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 55
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.033","0","242174","188"
"2023-10-28 11:00:46","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 85
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.032","0","230445","188"
"2023-10-27 17:16:09","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
                AND tmc.marketing_coupon_name LIKE concat('%','7.8','%')
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.032","0","449830","1"
"2023-10-28 11:16:14","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC1RDXKGEZW9X33ZOWM2V5'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.03","0","227959","1"
"2023-10-28 08:57:03","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                157
             , 
                137
             , 
                160
             , 
                128
             , 
                172
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.029","0","227936","84"
"2023-10-29 17:30:27","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.029","0","240338","188"
"2023-10-28 11:18:40","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 57
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.028","0","230549","188"
"2023-10-27 12:04:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.027","0","223470","188"
"2023-10-27 22:44:26","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 111
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.027","0","229467","188"
"2023-10-28 19:25:09","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDCEPL7425ZP65KJ860O1X3'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.027","0","231966","1"
"2023-10-29 17:31:49","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCXD6VE7M8V25D08OPN5K0'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.027","0","237750","1"
"2023-10-28 20:31:28","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 7
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.027","0","235115","188"
"2023-10-29 14:28:16","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 22
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.027","0","238489","188"
"2023-10-29 15:35:38","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 245
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.027","0.001","239230","188"
"2023-10-29 16:47:18","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 155
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.026","0","239854","188"
"2023-10-27 14:40:28","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.026","0","226333","188"
"2023-10-28 14:55:04","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.026","0","459380","1"
"2023-10-29 19:30:50","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC2MWXJY183W6E18K7G3VO'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.025","0","238874","1"
"2023-10-29 16:23:12","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 255
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.024","0","239644","188"
"2023-10-29 15:48:03","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCW9L471PZ5L4M1QK3V6DM'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.024","0","236724","1"
"2023-10-29 18:06:11","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDC5EX423WZOXDJZKDNVRO9'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.024","0","238053","1"
"2023-10-29 22:07:54","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 101
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.024","0","242620","188"
"2023-10-27 12:04:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.024","0","223470","188"
"2023-10-27 11:17:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.024","0","222935","188"
"2023-10-29 20:45:00","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDCD76EO1LQEVOK8Y0WJNMP'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.024","0","239482","1"
"2023-10-27 17:08:36","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 27
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.023","0.001","227340","188"
"2023-10-29 18:53:10","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 84
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.022","0","241120","188"
"2023-10-29 19:11:50","SELECT marketing_coupon_name AS couponName, marketing_coupon_type AS couponType, COUNT(1) AS sendNum
        FROM tenant_user_coupon
        WHERE relation_server_id = 7428815642662400
          AND is_del = 0
        GROUP BY marketing_coupon_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.022","0","238732","0"
"2023-10-29 23:01:16","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 126
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.021","0","242748","188"
"2023-10-29 17:47:48","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 80
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.021","0","240484","188"
"2023-10-29 16:07:25","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 188
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.021","0","239493","188"
"2023-10-27 11:37:49","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 123
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.02","0","222951","188"
"2023-10-27 15:11:52","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                157
             , 
                137
             , 
                160
             , 
                123
             , 
                128
             , 
                179
             , 
                180
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.02","0","224503","84"
"2023-10-29 11:22:26","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 40
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.019","0","237123","188"
"2023-10-29 13:53:23","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 165
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.019","0","238231","188"
"2023-10-27 17:16:00","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.019","0","449924","10"
"2023-10-29 17:47:48","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 7
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.018","0","240484","188"
"2023-10-29 16:54:18","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMDCXD6VE7M8VKLN0QOPN5K0'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.018","0","237331","1"
"2023-10-29 14:42:31","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 57
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.017","0","238621","188"
"2023-10-29 15:34:50","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 52
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.017","0.001","239186","188"
"2023-10-29 13:23:02","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 197
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.017","0","238011","188"
"2023-10-27 11:37:49","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 123
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.016","0","222951","188"
"2023-10-29 15:26:11","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.016","0","239123","188"
"2023-10-29 09:29:01","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 106
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.016","0.001","236722","188"
"2023-10-29 14:23:29","SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC LIMIT 0,10","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.016","0","472088","10"
"2023-10-29 20:54:38","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC0JVGE29QD23V0QRY1N54'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.016","0","239585","1"
"2023-10-29 12:53:11","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC3XRJEGW8NNP5V8910K5V'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.015","0","235288","1"
"2023-10-27 16:42:36","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 64
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.015","0","227158","188"
"2023-10-27 12:15:36","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.015","0","223474","188"
"2023-10-29 21:01:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 112
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.014","0","242254","188"
"2023-10-29 16:47:26","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCV65GPEOZ0KEJWZ2KJW1N'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.014","0","237264","1"
"2023-10-27 16:48:44","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                157
             , 
                137
             , 
                160
             , 
                128
             , 
                172
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.014","0","225081","84"
"2023-10-27 20:25:47","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 188
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.012","0","228907","188"
"2023-10-28 15:22:16","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC2MWXJY1831E0VQK7G3VO'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.012","0","229741","1"
"2023-10-29 18:12:06","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 126
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.012","0","240711","188"
"2023-10-29 13:53:23","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 165
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.01","0","238231","188"
"2023-10-28 19:58:57","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                172
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.01","0","232637","84"
"2023-10-29 18:53:10","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 13
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.009","0","241120","188"
"2023-10-27 12:16:17","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 120
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.009","0","223474","188"
"2023-10-29 13:53:46","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 161
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.009","0","238232","188"
"2023-10-27 15:36:37","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 185
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.009","0","226823","188"
"2023-10-27 11:08:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 15
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.008","0","222928","188"
"2023-10-29 15:34:00","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.008","0.001","239184","188"
"2023-10-29 23:01:16","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                180
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.007","0","240640","84"
"2023-10-29 19:11:50","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 40
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.25","1.007","0","241322","188"
"2023-10-27 17:15:59","SELECT COUNT(1) FROM ( SELECT
            tmc.marketing_coupon_id AS couponTempNo,
            tmc.marketing_coupon_outer_id AS marketingCouponOuterId,
            tmc.marketing_activity_id AS marketingActivityId,
            tmc.marketing_coupon_name AS marketingCouponName,
            tmc.marketing_coupon_name_remark AS marketingCouponNameRemark,
            tmc.marketing_coupon_type AS marketingCouponType,
            ( CASE tmc.marketing_coupon_type
                WHEN 0 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,减', 0 + CAST( tmc.marketing_coupon_deduction_amount AS CHAR ) )
                    END
                )
                WHEN 1 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,', 0 + CAST( tmc.marketing_coupon_discount * 10 AS CHAR ), '折' )
                    END
                )
                WHEN 2 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN CONCAT( '随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,随机减', 0 + CAST( tmc.marketing_coupon_random_start AS CHAR ), '-', 0 + CAST( tmc.marketing_coupon_random_end AS CHAR ) )
                    END
                )
                WHEN 3 THEN ( CASE tmc.marketing_coupon_threshold_type
                    WHEN 0 THEN '可兑换'
                    WHEN 1 THEN CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '元,可兑换' )
                    ELSE CONCAT( '满', 0 + CAST( tmc.marketing_coupon_threshold AS CHAR ), '件,可兑换' )
                    END
                )
            END
            )                           AS discountsContent,
            tmc.marketing_coupon_status AS marketingCouponStatus,
            IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) AS surplusNumber,
            IFNULL( alreadyUsetuc.count, 0 ) AS alreadyUseNumber,
            tmc.marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,
            tmc.marketing_coupon_discount AS marketingCouponDiscount,
            tmc.marketing_coupon_random_start AS marketingCouponRandomStart,
            tmc.marketing_coupon_random_end AS marketingCouponRandomEnd,
            tmc.marketing_coupon_start AS marketingCouponStart,
            tmc.marketing_coupon_end AS marketingCouponEnd,
            tmc.marketing_coupon_expiry_type AS marketingCouponExpiryType,
            tmc.marketing_coupon_expiry_start_day AS marketingCouponExpiryStartDay,
            tmc.marketing_coupon_expiry_day AS marketingCouponExpiryDay,
            tmc.marketing_coupon_icon_before AS marketingCouponIconBefore,
            tmc.marketing_coupon_icon_after AS marketingCouponIconAfter,
            tmc.marketing_coupon_get_user_limit AS marketingCouponGetUserLimit,
            tmc.marketing_coupon_get_limit AS marketingCouponGetLimit,
            tma.dealer_id AS dealerId,
            tma.store_id AS storeId
        FROM
            tenant_marketing_coupon tmc
            LEFT JOIN tenant_marketing_activity tma ON tmc.marketing_activity_id = tma.marketing_activity_id
            AND tma.is_del = 0
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                    AND tuc.marketing_coupon_status = 1
                GROUP BY
                    tuc.marketing_coupon_id
            ) alreadyUsetuc ON tmc.marketing_coupon_id = alreadyUsetuc.marketing_coupon_id
         WHERE tmc.is_del = 0
            
            
            
            
            
            
            
            AND tma.marketing_activity_id IN (
                1
            ,
                4
            ,
                6
            ,
                137
            ,
                139
            ,
                141
            ,
                142
            ,
                143
            ,
                145
            ,
                157
            ,
                158
            ,
                159
            ,
                160
            ,
                161
            ,
                164
            ,
                165
            ,
                166
            ,
                167
            ,
                168
            ,
                169
            ,
                170
            ,
                171
            ,
                196
            ,
                197
            ,
                198
            ) 
        GROUP BY
            tmc.marketing_coupon_outer_id
        ORDER BY
            tmc.marketing_coupon_status = 1,
            tmc.marketing_coupon_status = 2,
            tmc.marketing_coupon_status = 0,
            tmc.create_date DESC ) TOTAL","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.007","0","449962","1"
"2023-10-29 14:17:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 245
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.006","0.001","238416","188"
"2023-10-29 13:03:50","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.006","0","237907","188"
"2023-10-29 08:34:15","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 204
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.005","0","236689","188"
"2023-10-28 11:03:27","SELECT marketing_coupon_name AS couponName, marketing_coupon_type AS couponType, COUNT(1) AS sendNum
        FROM tenant_user_coupon
        WHERE relation_server_id = 7392915687356672
          AND is_del = 0
        GROUP BY marketing_coupon_id","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.005","0","227856","0"
"2023-10-29 23:03:38","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 1
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.11","1.005","0","242748","188"
"2023-10-27 22:40:00","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 88
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.004","0","229453","188"
"2023-10-29 19:59:08","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC35RJ1M9QR4YEKQEY7WVX'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.004","0","239037","1"
"2023-10-27 13:06:30","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 120
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.003","0","223487","188"
"2023-10-29 15:35:55","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 143
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.002","0","239230","188"
"2023-10-29 20:22:24","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRC1RDXKGEZW4J28OWM2V54'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.001","0","239260","1"
"2023-10-28 10:07:32","SELECT
            
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_type,
            tmgf.marketing_give_name,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.discount_detail_type,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_level,
            pmcj.product_activity_join_type,
            
            tdpj.dealer_product_join_outer_id,
            
            tmggd.tenant_give_discount_detail_id,
            tmggd.full_amount,
            tmggd.order_amount_discount,
            tmggd.reduction_amount,
            ( tmggd.discount_rate * 10 ) AS discount_rate,
            tmggd.is_give_product,
            tmggd.is_give_coupon,
            tmggd.user_max_optional_give_product_num,
            
            ddgpj.discount_detail_product_join_id,
            tp.is_del AS tpIsDel,
            tp.release_status AS tpReleaseStatus,
            tdpj2.dealer_product_join_outer_id AS give_dealer_product_join_outer_id,
            tdpj2.dealer_product_name,
            IFNULL( tosp.attr_pic, tdpj2.main_cover ) AS main_cover,
            tdpj2.is_del AS tdpjIsDel,
            tdpj2.is_complete AS isComplete,
            tpoo.product_onsale_status AS productOnsaleStatus,
            tdpj2.fare_template AS fareTemplate,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            ddgpj.give_product_num,
            tosp.is_del AS tospIsDel,
            tdpj2.has_express_delivery AS hasExpressDelivery,
            tdpj2.has_pick_up AS hasPickUp,
            tdpj2.has_in_city_delivery AS hasInCityDelivery,
            
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_name,
            (CASE tmggd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END)as surplusNumber,
            gddcj.give_coupon_num,
            tmc.marketing_coupon_type,
            
            sav.attr_id,
            sav.attr_value_id,
            sav.attr_value,
            sbca.attr_name
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_marketing_give_discount_detail tmggd ON tmggd.marketing_give_id = tmgf.marketing_give_inner_id
            LEFT JOIN tenant_product_marketing_activity_join pmcj ON pmcj.marketing_activity_id = tmgf.marketing_activity_id
            LEFT JOIN tenant_dealer_product_join tdpj ON tdpj.dealer_product_join_id = pmcj.dealer_product_join_id
            
            LEFT JOIN tenant_marketing_give_discount_detail_product_join ddgpj ON ddgpj.marketing_give_id = tmgf.marketing_give_inner_id
            AND ddgpj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tosp.onlinestore_single_product_inner_id = ddgpj.onlinestore_single_product_id
            LEFT JOIN tenant_dealer_product_join tdpj2 ON tdpj2.dealer_product_join_id = ddgpj.dealer_product_join_id
            LEFT JOIN tenant_product_onsale_onlinestore tpoo ON tdpj2.dealer_product_join_id = tpoo.dealer_product_join_id
            AND tpoo.store_id = 209
            LEFT JOIN tenant_product tp ON tosp.product_id = tp.product_inner_id
            
            LEFT JOIN tenant_onlinestore_single_attr_join tosaj ON tosaj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN sys_backend_category_attr sbca ON sbca.cate_attr_inner_id = tosaj.attr_id
            LEFT JOIN sys_attr_value sav ON tosaj.attr_value_id = sav.attr_value_id
            AND tosaj.attr_id = sav.attr_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join gddcj ON gddcj.marketing_give_id = tmgf.marketing_give_inner_id
            AND gddcj.discount_detail_id = tmggd.tenant_give_discount_detail_id
            AND gddcj.is_del =0
            LEFT JOIN tenant_marketing_coupon tmc ON tmc.marketing_coupon_id = gddcj.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) AS count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
         WHERE tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            
                     and tmgf.marketing_give_inner_id IN (
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        7
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ,
                        8
                    ) 
        ORDER BY
            tmgf.marketing_give_outer_id,
            tmggd.full_amount","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.9","1.001","0","230180","188"
"2023-10-27 21:43:07","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCW65KXJO8JEXW3QN3RGV4'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.001","0","226674","1"
"2023-10-29 17:15:11","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.2","1.001","0","238101","84"
"2023-10-29 14:28:16","SELECT
            tmgf.marketing_give_inner_id,
            tmgf.marketing_activity_id,
            tmgf.marketing_give_outer_id,
            tmgf.marketing_give_store_type,
            tmgf.marketing_give_status,
            tmgf.marketing_give_name,
            tmgf.dealer_id,
            tmgf.store_id,
            tmgf.marketing_give_type,
            tmgf.discount_detail_type,
            tmgf.marketing_give_start,
            tmgf.marketing_give_end,
            tmgf.main_cover,
            tmgf.marketing_give_display_name,

            tpmaj.product_activity_id,
            tpmaj.dealer_product_join_id,
            tpmaj.onlinestore_single_product_id,
            tpmaj.product_activity_join_type,

            tmgdj.marketing_give_discount_join_id,
            tmgdj.discount_type,

            tmgdd.tenant_give_discount_detail_id,
            tmgdd.marketing_give_id,
            tmgdd.full_amount,
            tmgdd.order_amount_discount,
            tmgdd.reduction_amount,
            tmgdd.discount_rate,
            tmgdd.is_give_product,
            tmgdd.user_max_optional_give_product_num,
            tmgdd.is_give_coupon,

            tmgddpj.discount_detail_product_join_id,
            tosp.onlinestore_single_product_inner_id,
            tosp.onlinestore_single_product_outer_id,
            tmgddpj.give_product_num,

            tmgddcj.discount_detail_coupon_join_id,
            tmc.marketing_coupon_outer_id,
            tmc.marketing_coupon_type,
            tmc.marketing_coupon_name,
            tmgddcj.give_coupon_num,
            (CASE tmgdd.is_give_coupon WHEN 1 THEN IFNULL( ( tmc.marketing_coupon_total_amount - IFNULL( surplustuc.count, 0 ) ), 0 ) ELSE null END) AS surplus_number,

            tmgf.marketing_give_level
        FROM
            tenant_marketing_give_full tmgf
            LEFT JOIN tenant_product_marketing_activity_join tpmaj ON tmgf.marketing_activity_id = tpmaj.marketing_activity_id
            LEFT JOIN tenant_marketing_give_discount_join tmgdj ON tmgf.marketing_give_inner_id = tmgdj.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail tmgdd ON tmgf.marketing_give_inner_id = tmgdd.marketing_give_id
            LEFT JOIN tenant_marketing_give_discount_detail_product_join tmgddpj ON tmgdd.tenant_give_discount_detail_id = tmgddpj.discount_detail_id
            LEFT JOIN tenant_onlinestore_single_product tosp ON tmgddpj.onlinestore_single_product_id = tosp.onlinestore_single_product_inner_id
            LEFT JOIN tenant_marketing_give_discount_detail_coupon_join tmgddcj ON tmgdd.tenant_give_discount_detail_id = tmgddcj.discount_detail_id
            AND tmgddcj.is_del = 0
            LEFT JOIN tenant_marketing_coupon tmc ON tmgddcj.marketing_coupon_id = tmc.marketing_coupon_id
            LEFT JOIN (
                SELECT
                    tuc.marketing_coupon_id,
                    COUNT( tuc.user_coupon_inner_id ) count
                FROM
                    tenant_user_coupon tuc
                WHERE
                    tuc.is_del = 0
                    AND tuc.user_inner_id IS NOT NULL
                GROUP BY
                    tuc.marketing_coupon_id
            ) surplustuc ON tmc.marketing_coupon_id = surplustuc.marketing_coupon_id
        WHERE
            tmgf.is_del = 0
            AND tmgf.marketing_give_status = 1
            AND tmgf.marketing_give_end >= NOW()
            AND tmgf.marketing_give_start  <=  NOW()
            AND tmgf.marketing_give_level = 1
             
                AND tmgf.marketing_give_store_type = 0
             
             AND tmgf.marketing_activity_id IN (  
                128
             , 
                146
             , 
                69
             , 
                46
             , 
                79
             , 
                63
             ) 
             AND tmgf.marketing_activity_id IN (  
                46
             , 
                164
             , 
                137
             , 
                157
             , 
                160
             , 
                128
             , 
                172
             , 
                179
             , 
                1
             , 
                143
             , 
                63
             )","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.17","1.001","0","236381","84"
"2023-10-27 16:43:40","SELECT  user_coupon_inner_id AS userCouponInnerId,user_coupon_outer_id AS userCouponOuterId,user_coupon_create_type AS userCouponCreateType,make_coupon_record_id AS makeCouponRecordId,user_coupon_no AS userCouponNo,marketing_activity_id AS marketingActivityId,marketing_coupon_id AS marketingCouponId,user_inner_id AS userInnerId,dealer_inner_id AS dealerInnerId,store_inner_id AS storeInnerId,marketing_activity_name AS marketingActivityName,marketing_coupon_name AS marketingCouponName,marketing_coupon_type AS marketingCouponType,marketing_coupon_start AS marketingCouponStart,marketing_coupon_end AS marketingCouponEnd,marketing_coupon_deduction_amount AS marketingCouponDeductionAmount,marketing_coupon_discount AS marketingCouponDiscount,has_discount_amount_limit AS hasDiscountAmountLimit,max_discount_amount_limit AS maxDiscountAmountLimit,has_discount_piece_limit AS hasDiscountPieceLimit,max_discount_piece_limit AS maxDiscountPieceLimit,marketing_coupon_overlay AS marketingCouponOverlay,marketing_coupon_intro AS marketingCouponIntro,marketing_coupon_status AS marketingCouponStatus,after_sales_status AS afterSalesStatus,after_sales_order_inner_id AS afterSalesOrderInnerId,marketing_coupon_from AS marketingCouponFrom,order_inner_id AS orderInnerId,relation_server_id AS relationServerId,marketing_coupon_remark AS marketingCouponRemark,redeem_code AS redeemCode,exchange_date AS exchangeDate,invalid_reason AS invalidReason,create_date AS createDate,update_date AS updateDate,is_del AS isDel,oper_user AS operUser  FROM tenant_user_coupon 
 WHERE  is_del=0
AND (user_coupon_outer_id IN ('TMFRCD76EO1LQE0KGJQY0WJNM'))","storesys_23wzoeqkdn","13d28dfd1c7e81b29c9513328b45befd","172.17.0.32","1.001","0","224568","1"
